"use strict";(self.webpackChunklegion_solver=self.webpackChunklegion_solver||[]).push([[792],{365:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(314),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,'body {\n    display: flex;\n    flex-direction: column;\n    font-family: \'Arial\', sans-serif;\n    margin: 0 auto;\n    padding: 20px;\n    min-height: 100vh;\n    background-color: #f5f5f5;\n    max-width: 1600px;\n}\n\nform {\n    margin-bottom: 0;\n}\n\n#title {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin-top: 0;\n    color: #333;\n}\n\n#header {\n    display: flex;\n    justify-content: flex-end;\n}\n\n#subtitle {\n    text-align: center;\n    color: #666;\n    margin-bottom: 5px;\n}\n\n#legionBoard {\n    border-spacing: 0;\n    border-collapse: collapse;\n    box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n    background-color: white;\n}\n\n#legionBoard td.legionCell {\n    width: 25px;\n    height: 27px;\n    border-style: solid;\n    border-width: 1px;\n    transition: background-color 0.2s;\n}\n\n#legionWrapper {\n    display: flex;\n    justify-content: center;\n}\n\n#legion {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n#legionFooter {\n    margin-top: 10px;\n    width: 100%;\n}\n\n#options {\n    display: flex;\n    flex-direction: column;\n    text-align: end;\n}\n\n#checkboxes {\n    margin-bottom: 10px;\n}\n\n#darkModeLabel {\n    padding-top: 10px;\n}\n\n#iterationTime {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-end;\n}\n\n#iterations, #time, #resetButton {\n  visibility: hidden;\n}\n\n#boardFilled {\n    margin-bottom: 7px;\n}\n\n#currentCaracterCount {\n    display: none;\n}\n\n#middlelabels {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n/* New Character Selection Panel Styles */\n#characterSelectionPanel {\n    margin-top: 25px;\n    padding: 15px;\n    background-color: #fff;\n    border-radius: 6px;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n    display: flex;\n    flex-direction: column;\n}\n\n#characterSelectionPanel h2 {\n    text-align: center;\n    color: #333;\n    margin-top: 0;\n    margin-bottom: 12px;\n    font-size: 18px;\n}\n\n/* New styling for the filter container at the top */\n#classCategories.filterContainer {\n    display: flex;\n    justify-content: center;\n    flex-wrap: wrap;\n    gap: 8px;\n    margin-bottom: 15px;\n    width: 100%;\n    padding-bottom: 12px;\n    border-bottom: 1px solid #eaeaea;\n}\n\n/* New container for the two-column layout */\n#characterSelectionContent {\n    display: flex;\n    gap: 15px;\n    margin-top: 10px;\n}\n\n/* Left column containing character info */\n#characterSelectionLeft {\n    flex: 0 0 300px;  /* Fixed width for the left column */\n    position: sticky;\n    top: 10px;\n    align-self: flex-start;\n}\n\n/* Right column containing character selector and categories */\n#characterSelectionRight {\n    flex: 1;  /* Take the rest of the available space */\n}\n\n#classCategories {\n    display: flex;\n    justify-content: center;\n    flex-wrap: wrap;\n    gap: 8px;\n    margin-bottom: 15px;\n}\n\n/* Styling for preset buttons */\n.presetBtn {\n    padding: 6px 12px;\n    background-color: #19a7c0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: 500;\n    font-size: 13px;\n    transition: all 0.2s;\n    border-bottom: 2px solid #4a6fa5;\n    margin: 0 5px;\n    min-width: 80px;\n}\n\n.presetBtn:hover {\n    background-color: #e8e8e8;\n}\n\n.presetBtn.active {\n    background-color: #4a6fa5;\n    color: white;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n/* Legacy category button styles - kept for reference */\n.categoryBtn {\n    padding: 6px 12px;\n    background-color: #f0f0f0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: 500;\n    font-size: 13px;\n    transition: all 0.2s;\n    border-bottom: 2px solid transparent;\n}\n\n/* Add class-specific colors to category buttons */\n.categoryBtn[data-category="warrior"] {\n    border-bottom: 2px solid #800000;\n}\n\n.categoryBtn[data-category="mage"] {\n    border-bottom: 2px solid #1e3a8a;\n}\n\n.categoryBtn[data-category="thief"] {\n    border-bottom: 2px solid #4b0082;\n}\n\n.categoryBtn[data-category="archer"] {\n    border-bottom: 2px solid #006400;\n}\n\n.categoryBtn[data-category="pirate"] {\n    border-bottom: 2px solid #5f9ea0;\n}\n\n.categoryBtn[data-category="special"] {\n    border-bottom: 2px solid #9370db;\n}\n\n.categoryBtn.active[data-category="warrior"] {\n    background-color: #800000;\n    color: white;\n}\n\n.categoryBtn.active[data-category="mage"] {\n    background-color: #1e3a8a;\n    color: white;\n}\n\n.categoryBtn.active[data-category="thief"] {\n    background-color: #4b0082;\n    color: white;\n}\n\n.categoryBtn.active[data-category="archer"] {\n    background-color: #006400;\n    color: white;\n}\n\n.categoryBtn.active[data-category="pirate"] {\n    background-color: #5f9ea0;\n    color: white;\n}\n\n.categoryBtn.active[data-category="special"] {\n    background-color: #9370db;\n    color: white;\n}\n\n.categoryBtn.active[data-category="all"] {\n    background-color: #4a6fa5;\n    color: white;\n}\n\n#characterSelector {\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n    margin-bottom: 20px;\n}\n\n/* Style for the container holding all characters - to be replaced */\n.all-characters-container {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n    gap: 10px;\n    margin-top: 15px;\n    width: 100%;\n}\n\n/* Style for the container with class sections */\n.character-sections-container {\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    width: 100%;\n}\n\n/* Style for each class section */\n.character-section {\n    background-color: #ffffff;\n    border-radius: 5px;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.08);\n    overflow: hidden;\n    margin-bottom: 14px;\n    border: 1px solid #eaeaea;\n}\n\n/* Style for class section headers */\n.character-section-header {\n    font-size: 14px;\n    font-weight: 600;\n    padding: 7px 12px;\n    margin: 0 0 6px 0;\n    color: white;\n    background-color: #4A4A4A;\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    user-select: none;\n    border-radius: 4px 4px 0 0;\n}\n\n.character-section-header:hover {\n    opacity: 0.95;\n}\n\n.section-toggle {\n    font-size: 11px;\n    transition: transform 0.2s;\n}\n\n/* Class-specific header colors - more visually appealing */\n.character-section:has([data-class="warrior"]) .character-section-header {\n    background-color: #FF5252; /* Vibrant red for warriors */\n}\n\n.character-section:has([data-class="mage"]) .character-section-header {\n    background-color: #448AFF; /* Bright blue for mages */\n}\n\n.character-section:has([data-class="thief"]) .character-section-header {\n    background-color: #9C27B0; /* Vibrant purple for thieves */\n}\n\n.character-section:has([data-class="archer"]) .character-section-header {\n    background-color: #4CAF50; /* Fresh green for archers */\n}\n\n.character-section:has([data-class="pirate"]) .character-section-header {\n    background-color: #FF9800; /* Bright orange for pirates */\n}\n\n.character-section:has([data-class="special"]) .character-section-header {\n    background-color: #7986CB; /* Soft indigo for special classes */\n}\n\n/* Style for the character cards container within each section */\n.character-cards-container {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));\n    gap: 6px;\n    padding: 0 10px 8px 10px;\n}\n\n.class-section-header {\n    font-size: 14px;\n    font-weight: 600;\n    padding: 6px 10px;\n    margin-top: 5px;\n    border-radius: 4px;\n    color: white;\n    display: flex;\n    align-items: center;\n}\n\n.class-section-header::before {\n    content: \'\';\n    display: inline-block;\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background-color: rgba(255, 255, 255, 0.7);\n    margin-right: 8px;\n}\n\n.class-section {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\n    gap: 8px;\n    padding-bottom: 5px;\n}\n\n/* Class-specific headers */\n.class-section-header[data-class="warrior"] {\n    background-color: #800000; /* Burgundy red for warriors */\n}\n\n.class-section-header[data-class="mage"] {\n    background-color: #1e3a8a; /* Deep blue for mages/wizards */\n}\n\n.class-section-header[data-class="thief"] {\n    background-color: #4b0082; /* Purple for thieves */\n}\n\n.class-section-header[data-class="archer"] {\n    background-color: #006400; /* Dark green for archers */\n}\n\n.class-section-header[data-class="pirate"] {\n    background-color: #5f9ea0; /* Cadet blue for pirates */\n}\n\n.class-section-header[data-class="special"] {\n    background-color: #9370db; /* Medium purple for special classes */\n}\n\n/* Character card styling - more compact */\n.characterCard {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 8px;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: all 0.2s;\n    background-color: #ffffff;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n    border: 1px solid #eaeaea;\n    height: 60px;  /* Reduce height from default */\n    font-size: 0.9em;  /* Slightly smaller font */\n}\n\n.characterCard:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    border-color: #c0c0c0;\n}\n\n.characterCard.selected {\n    border-color: #4a6fa5;\n    background-color: #f0f7ff;\n    box-shadow: 0 1px 3px rgba(74, 111, 165, 0.25);\n}\n\n/* Class-based styling for character cards with light background colors */\n.characterCard[data-class="warrior"] {\n    background-color: rgba(128, 0, 0, 0.08);\n    border-left: 3px solid #800000; /* Burgundy red for warriors */\n}\n\n.characterCard[data-class="mage"] {\n    background-color: rgba(30, 58, 138, 0.08);\n    border-left: 3px solid #1e3a8a; /* Deep blue for mages/wizards */\n}\n\n.characterCard[data-class="thief"] {\n    background-color: rgba(75, 0, 130, 0.08);\n    border-left: 3px solid #4b0082; /* Purple for thieves */\n}\n\n.characterCard[data-class="archer"] {\n    background-color: rgba(0, 100, 0, 0.08);\n    border-left: 3px solid #006400; /* Dark green for archers */\n}\n\n.characterCard[data-class="pirate"] {\n    background-color: rgba(95, 158, 160, 0.08);\n    border-left: 3px solid #5f9ea0; /* Cadet blue for pirates */\n}\n\n.characterCard[data-class="special"] {\n    background-color: rgba(147, 112, 219, 0.08);\n    border-left: 3px solid #9370db; /* Medium purple for special classes */\n}\n\n.characterName {\n    font-weight: 600;\n    margin-bottom: 4px;\n    font-size: 0.95em;  /* Reduced from default */\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    color: #333;\n}\n\n.characterClass {\n    font-size: 11px;\n    color: #555;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 3px;\n    margin-bottom: 1px;\n}\n\n.effect-icon {\n    font-size: 12px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    min-width: 16px;\n}\n\n.effect-text {\n    max-width: 86px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 10px;\n    line-height: 1.2;\n}\n\n#characterInfo {\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n    margin-top: 0;\n}\n\n#selectedCharacterDetails, #pieceSelection {\n    flex: 1;\n    padding: 0;\n    border-radius: 0;\n    background-color: transparent;\n}\n\n#selectedCharacterDetails h3, #pieceSelection h3 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 16px;\n    color: #444;\n}\n\n#characterDetailsContent {\n    color: #666;\n    font-style: italic;\n    padding: 8px;\n}\n\n#pieceSelectionContent {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 10px;\n    margin-bottom: 10px;\n}\n\n.selectedPiece {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 8px 10px;\n    margin-bottom: 6px;\n    background-color: white;\n    border-radius: 4px;\n    box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n}\n\n.selectedPiece .selectedPieceInfo {\n    display: flex;\n    align-items: baseline;\n    gap: 8px;\n}\n\n.selectedPiece .characterName {\n    font-size: 13px;\n    font-weight: 600;\n    color: #333;\n}\n\n.selectedPiece .characterLevel {\n    font-size: 11px;\n    color: #666;\n}\n\n.selectedPiece[data-character-class="warrior"] {\n    background-color: rgba(128, 0, 0, 0.05);\n    border-left: 3px solid #800000; /* Burgundy red for warriors */\n}\n\n.selectedPiece[data-character-class="mage"] {\n    background-color: rgba(30, 58, 138, 0.05);\n    border-left: 3px solid #1e3a8a; /* Deep blue for mages/wizards */\n}\n\n.selectedPiece[data-character-class="thief"] {\n    background-color: rgba(75, 0, 130, 0.05);\n    border-left: 3px solid #4b0082; /* Purple for thieves */\n}\n\n.selectedPiece[data-character-class="archer"] {\n    background-color: rgba(0, 100, 0, 0.05);\n    border-left: 3px solid #006400; /* Dark green for archers */\n}\n\n.selectedPiece[data-character-class="pirate"] {\n    background-color: rgba(95, 158, 160, 0.05);\n    border-left: 3px solid #5f9ea0; /* Cadet blue for pirates */\n}\n\n.selectedPiece[data-character-class="special"] {\n    background-color: rgba(147, 112, 219, 0.05);\n    border-left: 3px solid #9370db; /* Medium purple for special classes */\n}\n\n.removePieceBtn {\n    background: none;\n    border: none;\n    font-size: 16px;\n    cursor: pointer;\n    color: #999;\n    padding: 2px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s;\n}\n\n.removePieceBtn:hover {\n    color: #e74c3c;\n}\n\nbutton {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 4px;\n    background-color: #4a6fa5;\n    color: white;\n    cursor: pointer;\n    transition: background-color 0.2s;\n}\n\nbutton:hover {\n    background-color: #3d5d8a;\n}\n\n#clearPieces, #clearBoard, #resetButton {\n    background-color: #d32f2f;\n}\n\n#clearPieces:hover, #clearBoard:hover, #resetButton:hover {\n    background-color: #b71c1c;\n}\n\n#boardButton {\n    background-color: #2e7d32;\n}\n\n#boardButton:hover {\n    background-color: #1b5e20;\n}\n\n.centerMiddleChild {\n    display: flex;\n}\n\n.centerMiddleChild > :nth-child(1), .centerMiddleChild > :nth-child(3) {\n    flex: 1;\n}\n\n#instructions {\n    display: none;\n}\n\n#paragraph {\n    padding-right: 80px;\n}\n\n#currentPieces {\n    white-space: nowrap;\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n    #legionWrapper {\n        flex-direction: column;\n        align-items: center;\n    }\n    \n    #instructions {\n        display: none;\n        margin-left: 0;\n        margin-top: 20px;\n    }\n    \n    #paragraph {\n        padding-right: 0;\n    }\n    \n    #characterInfo {\n        flex-direction: column;\n    }\n    \n    #characterSelectionContent {\n        flex-direction: column-reverse;\n    }\n    \n    #characterSelectionLeft, #characterSelectionRight {\n        width: 100%;\n    }\n\n    /* Responsive styling for the filter container */\n    #classCategories.filterContainer {\n        margin-bottom: 12px;\n        padding-bottom: 10px;\n    }\n}\n\n/* Dark Mode Styles */\nbody.dark-mode {\n    background-color: #1a1a1a;\n    color: #e0e0e0;\n}\n\nbody.dark-mode #title, \nbody.dark-mode h2, \nbody.dark-mode h3 {\n    color: #f0f0f0;\n}\n\nbody.dark-mode #subtitle {\n    color: #aaa;\n}\n\nbody.dark-mode #legionBoard,\nbody.dark-mode #characterSelectionPanel,\nbody.dark-mode #selectedCharacterDetails, \nbody.dark-mode #pieceSelection {\n    background-color: #2a2a2a;\n}\n\nbody.dark-mode .presetBtn {\n    background-color: #333;\n    color: #ddd;\n}\n\nbody.dark-mode .presetBtn:hover {\n    background-color: #444;\n}\n\nbody.dark-mode .presetBtn.active {\n    background-color: #5d84c0;\n}\n\nbody.dark-mode .categoryBtn {\n    background-color: #333;\n    color: #ddd;\n}\n\nbody.dark-mode .categoryBtn:hover {\n    background-color: #444;\n}\n\nbody.dark-mode .categoryBtn.active {\n    background-color: #5d84c0;\n}\n\nbody.dark-mode .characterCard {\n    background-color: #2a2a2a;\n    border-color: #3a3a3a;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n}\n\nbody.dark-mode .characterCard:hover {\n    background-color: #333;\n    border-color: #444;\n}\n\nbody.dark-mode .characterName {\n    color: #e0e0e0;\n}\n\nbody.dark-mode .characterClass {\n    color: #aaa;\n}\n\nbody.dark-mode .character-section {\n    background-color: #222;\n    border-color: #333;\n}\n\nbody.dark-mode .character-section-header {\n    background-color: #333;\n}\n\nbody.dark-mode .character-section-content {\n    background-color: #2a2a2a;\n}\n\nbody.dark-mode .character-details-header,\nbody.dark-mode .selected-pieces-header {\n    background-color: #222222;\n}\n\nbody.dark-mode #characterDetailsContent {\n    color: #aaa;\n}\n\n.characterDetailCard {\n    padding: 15px;\n    border-radius: 6px;\n    background-color: #f9f9f9;\n    box-shadow: 0 1px 4px rgba(0,0,0,0.1);\n    border-left: 3px solid #4a6fa5;\n}\n\n.characterDetailCard h4 {\n    margin: 0 0 12px 0;\n    font-size: 18px;\n    color: #333;\n}\n\n.characterDetailCard p {\n    margin: 6px 0;\n    line-height: 1.4;\n    color: #555;\n}\n\n/* Class-specific styles for the detail view */\n.characterDetailCard[data-class="warrior"] {\n    background-color: rgba(128, 0, 0, 0.05);\n    border-left: 3px solid #800000;\n}\n\n.characterDetailCard[data-class="mage"] {\n    background-color: rgba(30, 58, 138, 0.05);\n    border-left: 3px solid #1e3a8a;\n}\n\n.characterDetailCard[data-class="thief"] {\n    background-color: rgba(75, 0, 130, 0.05);\n    border-left: 3px solid #4b0082;\n}\n\n.characterDetailCard[data-class="archer"] {\n    background-color: rgba(0, 100, 0, 0.05);\n    border-left: 3px solid #006400;\n}\n\n.characterDetailCard[data-class="pirate"] {\n    background-color: rgba(95, 158, 160, 0.05);\n    border-left: 3px solid #5f9ea0;\n}\n\n.characterDetailCard[data-class="special"] {\n    background-color: rgba(147, 112, 219, 0.05);\n    border-left: 3px solid #9370db;\n}\n\n#addCharacterBtn {\n    display: block;\n    width: 100%;\n    margin-top: 15px;\n    padding: 8px;\n    background-color: #4a6fa5;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    font-weight: 500;\n    font-size: 13px;\n    cursor: pointer;\n    transition: background-color 0.2s;\n}\n\n#addCharacterBtn:hover {\n    background-color: #3d5d8a;\n}\n\n/* Level Selection Styles */\n.level-selection {\n    margin: 12px 0;\n    padding: 8px 10px;\n    background-color: rgba(0, 0, 0, 0.03);\n    border-radius: 4px;\n}\n\n.level-selection p {\n    margin-top: 0;\n    margin-bottom: 6px;\n    font-weight: 600;\n    font-size: 13px;\n    color: #444;\n}\n\n.level-options {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    gap: 4px;\n}\n\n.level-option {\n    flex: 1;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    padding: 4px 2px;\n    border-radius: 4px;\n    background-color: #f0f0f0;\n    border: 1px solid #ddd;\n    transition: all 0.2s;\n    font-size: 12px;\n    text-align: center;\n}\n\n.level-option:hover {\n    background-color: #e8e8e8;\n}\n\n.level-option input[type="radio"] {\n    margin-right: 2px;\n    transform: scale(0.8);\n}\n\n.level-option input[type="radio"]:checked + span {\n    font-weight: bold;\n    color: #4a6fa5;\n}\n\n.level-option:has(input[type="radio"]:checked) {\n    background-color: #e0e7f5;\n    border-color: #a0c0e0;\n}\n\n/* Piece Shape Visualization */\n.piece-preview {\n  display: inline-block;\n  margin-left: 5px;\n  vertical-align: middle;\n  transform: scale(0.9);\n}\n\n.piece-shape-visual {\n  margin: 5px 0;\n  display: inline-block;\n}\n\n/* Add the following classes for piece colors */\n.selectedPiece.piece-lvl60 {\n    border-left: 4px solid lightpink;\n}\n.selectedPiece.piece-lvl100 {\n    border-left: 4px solid lightcoral;\n}\n.selectedPiece.piece-lvl140-warrior-pirate {\n    border-left: 4px solid indianred;\n}\n.selectedPiece.piece-lvl140-mage-thief-archer {\n    border-left: 4px solid darkseagreen;\n}\n.selectedPiece.piece-lvl200-warrior {\n    border-left: 4px solid firebrick;\n}\n.selectedPiece.piece-lvl200-archer {\n    border-left: 4px solid mediumseagreen;\n}\n.selectedPiece.piece-lvl200-thief-lab {\n    border-left: 4px solid purple;\n}\n.selectedPiece.piece-lvl200-mage {\n    border-left: 4px solid dodgerblue;\n}\n.selectedPiece.piece-lvl200-pirate {\n    border-left: 4px solid lightsteelblue;\n}\n.selectedPiece.piece-lvl250-warrior {\n    border-left: 4px solid maroon;\n}\n.selectedPiece.piece-lvl250-archer {\n    border-left: 4px solid green;\n}\n.selectedPiece.piece-lvl250-thief {\n    border-left: 4px solid indigo;\n}\n.selectedPiece.piece-lvl250-mage {\n    border-left: 4px solid blue;\n}\n.selectedPiece.piece-lvl250-pirate {\n    border-left: 4px solid cadetblue;\n}\n.selectedPiece.piece-lvl250-xenon {\n    border-left: 4px solid mediumpurple;\n}\n.selectedPiece.piece-lab-enhanced {\n    border-left: 4px solid aquamarine;\n}\n\n.categoryBtn:hover {\n    background-color: #e8e8e8;\n}\n\n.filterContainer {\n    display: flex;\n    justify-content: center;\n    margin-bottom: 15px;\n}\n\nbody.dark-mode .characterCard.selected {\n    background-color: #3a3a3a;\n    border-color: #5d84c0;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.3);\n}\n\n/* Styling for the character details and selected pieces headers */\n.character-details-header {\n    background-color: #333333; /* Black background as requested */\n}\n\n.selected-pieces-header {\n    background-color: #333333; /* Black background as requested */\n}\n\n/* Style for the character section content */\n.character-section-content {\n    padding: 12px;\n}\n\n/* Style the clear button to be consistent with the design */\n#clearPieces {\n    margin-top: 10px;\n    display: block;\n    width: 100%;\n}\n\n/* Adjust the colors slightly for dark mode */\nbody.dark-mode .character-section:has([data-class="warrior"]) .character-section-header {\n    background-color: #C62828; /* Darker red for dark mode */\n}\n\nbody.dark-mode .character-section:has([data-class="mage"]) .character-section-header {\n    background-color: #1976D2; /* Darker blue for dark mode */\n}\n\nbody.dark-mode .character-section:has([data-class="thief"]) .character-section-header {\n    background-color: #7B1FA2; /* Darker purple for dark mode */\n}\n\nbody.dark-mode .character-section:has([data-class="archer"]) .character-section-header {\n    background-color: #2E7D32; /* Darker green for dark mode */\n}\n\nbody.dark-mode .character-section:has([data-class="pirate"]) .character-section-header {\n    background-color: #E65100; /* Darker orange for dark mode */\n}\n\nbody.dark-mode .character-section:has([data-class="special"]) .character-section-header {\n    background-color: #5C6BC0; /* Darker indigo for dark mode */\n}\n\nbody.dark-mode .selectedPiece {\n    background-color: #333;\n    border: 1px solid #555;\n}\n\nbody.dark-mode .character-section-content {\n    background-color: #2a2a2a;\n}\n\nbody.dark-mode .character-details-header,\nbody.dark-mode .selected-pieces-header {\n    background-color: #222222;\n}\n\nbody.dark-mode #characterDetailsContent {\n    color: #aaa;\n}\n\n/* Dark mode for the filter container border */\nbody.dark-mode #classCategories.filterContainer {\n    border-bottom: 1px solid #444;\n}\n\n/* Allow more space for the grid when the screen is wide enough */\n@media (min-width: 1400px) {\n    .character-cards-container {\n        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));  /* More cards per row on wider screens */\n    }\n}\n\n/* Character count styles */\n.character-count {\n    font-size: 0.9em;\n    color: rgba(255, 255, 255, 0.8);\n    font-weight: normal;\n    margin-left: 5px;\n}\n\nbody.dark-mode .character-count {\n    color: rgba(255, 255, 255, 0.7);\n}\n\n/* Character class color styles for selected pieces */\n.selectedPiece.warrior-color {\n    border-left: 4px solid #800000 !important; /* Burgundy red for warriors */\n}\n\n.selectedPiece.mage-color {\n    border-left: 4px solid #1e3a8a !important; /* Deep blue for mages/wizards */\n}\n\n.selectedPiece.thief-color {\n    border-left: 4px solid #4b0082 !important; /* Purple for thieves */\n}\n\n.selectedPiece.archer-color {\n    border-left: 4px solid #006400 !important; /* Dark green for archers */\n}\n\n.selectedPiece.pirate-color {\n    border-left: 4px solid #5f9ea0 !important; /* Cadet blue for pirates */\n}\n\n.selectedPiece.special-color {\n    border-left: 4px solid #9370db !important; /* Medium purple for special classes */\n}\n\n/* Add the following classes for piece colors */',""]);const a=r},143:(e,t,n)=>{var o=n(72),r=n.n(o),a=n(365);r()(a.A,{insert:"head",singleton:!1}),a.A.locals;const i={GMS:{title:"Legion Solver v2",instructions:"Instructions:",instructionsSub1:"1. Click the grid spaces you want to be filled, the region click will help you fill it in faster.",instructionsSub2:"2. Input the amount of each shape you want to be filled in the board.",instructionsSub3:"3. The space that the pieces take up should equal the amount of grid spaces you filled, although the program will still try to run otherwise.",instructionsSub4:"4. When you press Start the program will try to fill the board spaces with the pieces you've chosen, click on Live Solve if you want to see the board filled in real time.",spacesToBeFilled:"Spaces to be Filled: ",boardSpacesFilled:"Board Spaces Filled: ",currentCaracterCountFiled:"Number of Characters: ",iterations:"Iterations: ",time:"Time: ",bigClick:"Region Click",liveSolve:"Live Solve",darkMode:"Dark Mode",start:"Start",pause:"Pause",continue:"Continue",reset:"Reset",clearPieces:"Clear Pieces",clearBoard:"Clear Board",failText:"No Solution Found",lvl60:"Lvl 60",lvl100:"Lvl 100",warriorPirate140:"Lvl 140 Warrior/Pirate",mageThiefArcher140:"Lvl 140 Mage/Thief/Archer",warrior200:"Lvl 200 Warrior",archer200:"Lvl 200 Archer",thiefLab200:"Lvl 200 Thief/Lab",mage200:"Lvl 200 Mage",pirate200:"Lvl 200 Pirate",warrior250:"Lvl 250 Warrior",archer250:"Lvl 250 Archer",thief250:"Lvl 250 Thief/Ride or Die",mage250:"Lvl 250 Mage",pirate250:"Lvl 250 Pirate/Abyssal",xenon250:"Lvl 250 Xenon",enhancedLab200:"Lvl 200 Enhanced Lab",enhancedLab250:"Lvl 250 Enhanced Lab",lab250:"Lvl 250 Lab"},KMS:{title:"유니온 지도 메이커",instructions:"설명:",instructionsSub1:"1. 유니온 지도를 더 빨리 채우려면 지역선택 버튼을 활성화 한 후 지역을 선택하세요.",instructionsSub2:"2. 유니온 지도에 채우려는 직업의 수를 입력하세요.",instructionsSub3:"3. 산정된 공간은 선택된 공간의 양과 같아야 하며 같지 않다면 프로그램은 계속 반복 실행할 겁니다.",instructionsSub4:"4. 프로그램이 루트를 찾고 있을 때 해당 과정을 보고 싶다면 실시간 보기를 활성화해 줍니다.",spacesToBeFilled:"유니온 캐릭터 산정된 공간: ",boardSpacesFilled:"유니온 지도 선택된 공간: ",currentCaracterCountFiled:"현재 사용 중인 문자 수: ",iterations:"반복횟수: ",time:"소요시간: ",bigClick:"지역선택",liveSolve:"실시간 보기",darkMode:"다크모드",start:"시작",pause:"Pause",continue:"Continue",reset:"리셋",clearPieces:"캐릭터 초기화",clearBoard:"유니온 지도 초기화",failText:"루트를 찾지 못했습니다.",lvl60:"Lvl 60",lvl100:"Lvl 100",warriorPirate140:"Lvl 140 전사/해적",mageThiefArcher140:"Lvl 140 마법사/도적/궁수/메이플M(S)",warrior200:"Lvl 200 전사",archer200:"Lvl 200 궁수/메이플M(SS)",thiefLab200:"Lvl 200 도적/제논",mage200:"Lvl 200 마법사",pirate200:"Lvl 200 해적",warrior250:"Lvl 250 전사",archer250:"Lvl 250 궁수",thief250:"Lvl 250 도적",mage250:"Lvl 250 마법사",pirate250:"Lvl 250 해적",xenon250:"Lvl 250 제논",enhancedLab200:"Lvl 200 Enhanced Lab",enhancedLab250:"Lvl 250 Enhanced Lab",lab250:"Lvl 250 Lab"},JMS:{title:"ユニオンマップメーカー",instructions:"説明:",instructionsSub1:"1. ユニオンマップをもっと早く埋めるためには地域選択のボタンを活性化してから地域を選択してください。",instructionsSub2:"2. ユニオンマップに埋めようとする職業の数を入力してください。",instructionsSub3:"3. 算定された空間は選択された空間の量と同じでなければならず、同じでなければプログラムは繰り返します。",instructionsSub4:"4. プログラムがルートを探しているときにその状況を見たいなら、実時間見るボタンを活性化してください。",spacesToBeFilled:"キャラクターの算定された空間: ",boardSpacesFilled:"マップの選択された空間: ",currentCaracterCountFiled:"現在使用されている役割の数: ",iterations:"繰り返した数: ",time:"所要時間: ",bigClick:"地域選択",liveSolve:"実時間見る",darkMode:"ダークモード",start:"スタート",pause:"ポーズ",continue:"コンティニュー",reset:"リセット",clearPieces:"キャラクター初期化",clearBoard:"マップ初期化",failText:"ルートが見つかりませんでした",lvl60:"Lvl 60",lvl100:"Lvl 100",warriorPirate140:"Lvl 140 戦士/海賊",mageThiefArcher140:"Lvl 140 魔法使い/盗賊/弓",warrior200:"Lvl 200 戦士",archer200:"Lvl 200 弓",thiefLab200:"Lvl 200 盗賊/ゼノン",mage200:"Lvl 200 魔法使い",pirate200:"Lvl 200 海賊",warrior250:"Lvl 250 戦士",archer250:"Lvl 250 弓",thief250:"Lvl 250 盗賊",mage250:"Lvl 250 魔法使い",pirate250:"Lvl 250 海賊",xenon250:"Lvl 250 ゼノン",enhancedLab200:"Lvl 200 Enhanced Lab",enhancedLab250:"Lvl 250 Enhanced Lab",lab250:"Lvl 250 Lab"},TMS:{title:"聯盟戰地排序工具",instructions:"說明:",instructionsSub1:"1. 點選你所需要的格子，也可以使用區塊選擇以直接選取整個區塊。",instructionsSub2:"2. 輸入你擁有的拼圖數量。",instructionsSub3:"3. 確認可使用區塊數及可填入區塊數相等，否則程式將會無限循環。",instructionsSub4:"4. 點擊開始程式將使用你輸入的拼圖填滿區塊，點擊觀看過程可以觀看程式計算的過程。",spacesToBeFilled:"可填入區塊數: ",boardSpacesFilled:"可使用區塊數: ",currentCaracterCountFiled:"當前使用的角色數量: ",iterations:"嘗試次數: ",time:"花費時間: ",bigClick:"區塊選擇",liveSolve:"觀看過程",darkMode:"深色模式",start:"開始",pause:"暫停",continue:"繼續",reset:"重置",clearPieces:"清除擁有的拼圖",clearBoard:"清除面板",failText:"找不到結果",lvl60:"Lvl 60",lvl100:"Lvl 100",warriorPirate140:"Lvl 140 劍士/海盜",mageThiefArcher140:"Lvl 140 法師/盜賊/弓箭手",warrior200:"Lvl 200 劍士",archer200:"Lvl 200 弓箭手",thiefLab200:"Lvl 200 盜賊/Lab",mage200:"Lvl 200 法師",pirate200:"Lvl 200 海盜",warrior250:"Lvl 250 劍士",archer250:"Lvl 250 弓箭手",thief250:"Lvl 250 盜賊",mage250:"Lvl 250 法師",pirate250:"Lvl 250 海盜",xenon250:"Lvl 250 傑諾",enhancedLab200:"Lvl 200 強化型 Lab",enhancedLab250:"Lvl 250 強化型 Lab",lab250:"Lvl 250 Lab"},CMS:{title:"冒险岛联盟自动排列工具",instructions:"使用方法：",instructionsSub1:"1. 点击你想要使用的区块，或者可以使用选取整个区块功能。",instructionsSub2:"2. 输入你拥有的角色拼图数量。",instructionsSub3:"3. 必须要确定可使用的区块数量和可填入的区块数量相等，否则自动排列程序将陷入死循环。",instructionsSub4:"4. 只要点击开始，程序就会自动按照你输入的拼图数量填满区块。你也可以打开实时演算功能来查看过程。",spacesToBeFilled:"可填入的区块数量: ",boardSpacesFilled:"可使用的区块数量: ",currentCaracterCountFiled:"當当前使用的角色数量: ",iterations:"尝试次数: ",time:"消耗时间: ",bigClick:"选取整个区块",liveSolve:"实时演算",darkMode:"暗黑模式",start:"开始",pause:"暂停",continue:"继续",reset:"重置",clearPieces:"清除所有的拼图",clearBoard:"清除面板",failText:"找不到解",lvl60:"等级 60",lvl100:"等级 100",warriorPirate140:"等级 140 战士/海盗",mageThiefArcher140:"等级 140 魔法师/飞侠/尖兵/弓箭手",warrior200:"等级 200 战士",archer200:"等级 200 弓箭手",thiefLab200:"等级 200 飞侠/尖兵",mage200:"等级 200 魔法师",pirate200:"等级 200 海盗",warrior250:"等级 250 战士",archer250:"等级 250 弓箭手",thief250:"等级 250 飞侠",mage250:"等级 250 魔法师",pirate250:"等级 250 海盗",xenon250:"等级 250 尖兵",enhancedLab200:"Lvl 200 Enhanced Lab",enhancedLab250:"Lvl 250 Enhanced Lab",lab250:"Lvl 250 Lab"}};let l=c();function c(){const e=function(){let e;switch(window.navigator.userLanguage||window.navigator.language){case"en":e="GMS";break;case"ko":e="KMS";break;case"ja":e="JMS";break;case"cn":e="CMS";break;default:e=null}return e}();return localStorage.getItem("i18n")||e||"GMS"}function s(e){return i[l][e]}function d(e,t){const n=[],o=/^\s*$/;return function e(r){if(3==r.nodeType)!t&&o.test(r.nodeValue)||n.push(r);else for(var a=0,i=r.childNodes.length;a<i;++a)e(r.childNodes[a])}(e),n}document.getElementById("title").textContent=s("title"),d(document.getElementById("instructions"))[0].textContent=s("instructions"),d(document.getElementById("paragraph"))[0].textContent=s("instructionsSub1"),d(document.getElementById("paragraph"))[1].textContent=s("instructionsSub2"),d(document.getElementById("paragraph"))[2].textContent=s("instructionsSub3"),d(document.getElementById("paragraph"))[3].textContent=s("instructionsSub4"),d(document.getElementById("currentPieces"))[0].textContent=s("spacesToBeFilled"),d(document.getElementById("boardFilled"))[0].textContent=s("boardSpacesFilled"),d(document.getElementById("currentCaracterCount"))[0].textContent=s("currentCaracterCountFiled"),d(document.getElementById("iterations"))[0].textContent=s("iterations"),d(document.getElementById("time"))[0].textContent=s("time"),document.querySelector('label[for="bigClick"]').textContent=s("bigClick"),document.querySelector('label[for="liveSolve"]').textContent=s("liveSolve"),document.querySelector('label[for="darkMode"]').textContent=s("darkMode"),document.getElementById("boardButton").textContent=s("start"),document.getElementById("resetButton").textContent=s("reset"),document.getElementById("clearPieces").textContent=s("clearPieces"),document.getElementById("clearBoard").textContent=s("clearBoard"),document.getElementById("failText").textContent=s("failText"),document.getElementById("languageSelectBox").addEventListener("change",(function(){localStorage.setItem("i18n",this.value),location.reload()})),document.getElementById(l).selected=!0;class p{constructor(e,t){this.x=e,this.y=t}}var g,h,u=n(543);class m{constructor(e,t,n){this.shape=e,this.amount=t,this.id=n}static createPiece(e,t){return new m(e,t,this.curId++)}get cellCount(){Object.defineProperty(this,"cellCount",{value:0,writable:!0});for(let e=0;e<this.shape.length;++e)for(let t=0;t<this.shape[e].length;++t)this.shape[e][t]>0&&this.cellCount++;return this.cellCount}get pointShape(){Object.defineProperty(this,"pointShape",{value:[]});for(let e=0;e<this.shape.length;++e)for(let t=0;t<this.shape[e].length;++t)1==this.shape[e][t]?this.pointShape.push(new f(t,e,!1)):2==this.shape[e][t]&&this.pointShape.push(new f(t,e,!0));return this.pointShape}get offCenter(){Object.defineProperty(this,"offCenter",{value:0,writable:!0});for(let e=0;e<this.shape[0].length;e++)if(0!=this.shape[0][e]){this.offCenter=e;break}return this.offCenter}get transformations(){Object.defineProperty(this,"transformations",{value:[],writable:!0});let e,t=[...this.shape];for(let n=0;n<2;n++){for(let n=0;n<4;n++){e=new Array(t[0].length).fill(0).map((()=>new Array(t.length).fill(0)));for(let n=0;n<t.length;n++)for(let o=0;o<t[0].length;o++)0!=t[n][o]&&(e[t[0].length-o-1][n]=t[n][o]);t=e,this.transformations.push(new m(t,this.amount,this.id))}e=new Array(t.length).fill(0).map((()=>new Array(t[0].length).fill(0)));for(let n=0;n<t.length;n++)for(let o=0;o<t[0].length;o++)0!=t[n][o]&&(e[t.length-n-1][o]=t[n][o]);t=e}return this.transformations=u.unionWith(this.transformations,u.isEqual),this.transformations}get pointTransformations(){Object.defineProperty(this,"pointTransformations",{value:[]});for(let e of this.transformations)this.pointTransformations.push(e.pointShape);return this.pointTransformations}get restrictedTransformations(){Object.defineProperty(this,"restrictedTransformations",{value:[]});for(let e of this.transformations)e.shape[0][1+e.offCenter]&&0!=e.shape[0][1+e.offCenter]||this.restrictedTransformations.push(e);return this.restrictedTransformations}get restrictedPointTransformations(){Object.defineProperty(this,"restrictedPointTransformations",{value:[]});for(let e of this.restrictedTransformations)this.restrictedPointTransformations.push(e.pointShape);return this.restrictedPointTransformations}}g=m,(h=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(h="curId"))in g?Object.defineProperty(g,h,{value:1,enumerable:!0,configurable:!0,writable:!0}):g[h]=1;class f extends p{constructor(e,t,n){super(e,t),this.isMiddle=n}}const b="boardFilled",y="pieceAmounts",v="currentPieces",x=[[[2]],[[2,2]],[[1,0],[2,1]],[[1,2,1]],[[2,2],[2,2]],[[1,2,2,1]],[[1,0,0],[1,2,1]],[[0,1,0],[1,2,1]],[[1,2,0],[0,2,1]],[[1,1,2],[0,1,1]],[[1,1,2,1,1]],[[1,0,1],[1,2,1],[1,0,1]],[[0,1,0],[1,2,1],[0,1,0]],[[1,2,0,0],[0,1,1,1]],[[1,1,0],[0,2,0],[0,1,1]]],S=[[[1,0,0,0],[0,1,2,1]],[[1,0,0,0,1],[0,1,2,1,0]],[[1,0,1],[1,2,1]]],w=[];m.curId=1;for(let e of x)w.push(m.createPiece(e,0));function I(){return!!["GMS","TMS"].find((e=>e===c()))}if(I())for(let e of S)w.push(m.createPiece(e,0));let k=new Map;k.set(-1,"white"),k.set(0,"grey");for(let e=0;e<2;e++)k.set(1+18*e,"lightpink"),k.set(2+18*e,"lightcoral"),k.set(3+18*e,"indianred"),k.set(4+18*e,"darkseagreen"),k.set(5+18*e,"firebrick"),k.set(6+18*e,"mediumseagreen"),k.set(7+18*e,"purple"),k.set(8+18*e,"dodgerblue"),k.set(9+18*e,"lightsteelblue"),k.set(10+18*e,"maroon"),k.set(11+18*e,"green"),k.set(12+18*e,"indigo"),k.set(13+18*e,"blue"),k.set(14+18*e,"cadetblue"),k.set(15+18*e,"mediumpurple"),k.set(16+18*e,"aquamarine"),k.set(17+18*e,"aquamarine"),k.set(18+18*e,"aquamarine");function E(){if(document.querySelector("#pieceForm form")){for(let e=0;e<w.length;e++){let t=`<tr>${'<td class="pieceCell"></td>'.repeat(w[e].shape[0].length)}</tr>`.repeat(w[e].shape.length);document.querySelector("#pieceForm form").innerHTML+=`<div class="piece">\n            <div id="pieceDescription${e+1}"></div>\n            <label for="piece${e+1}">\n                <table id="pieceDisplay${e+1}">\n                    <tbody>${t}</tbody>\n                </table>\n            </label>\n            <input id="piece${e+1}" type="number" min=0 value=0>\n        </div>`,document.getElementById(`pieceDisplay${e+1}`).style.borderCollapse="collapse",document.getElementById(`pieceDisplay${e+1}`).style.borderSpacing="0",document.getElementById(`pieceDescription${e+1}`).style.paddingRight="15px";for(let t=0;t<w[e].shape.length;t++)for(let n=0;n<w[e].shape[t].length;n++)0!=w[e].shape[t][n]&&(document.getElementById(`pieceDisplay${e+1}`).getElementsByTagName("tr")[t].getElementsByTagName("td")[n].style.background=k.get(e+1))}document.getElementById("pieceDescription1").textContent=s("lvl60"),document.getElementById("pieceDescription2").textContent=s("lvl100"),document.getElementById("pieceDescription3").textContent=s("warriorPirate140"),document.getElementById("pieceDescription4").textContent=s("mageThiefArcher140"),document.getElementById("pieceDescription5").textContent=s("warrior200"),document.getElementById("pieceDescription6").textContent=s("archer200"),document.getElementById("pieceDescription7").textContent=s("thiefLab200"),document.getElementById("pieceDescription8").textContent=s("mage200"),document.getElementById("pieceDescription9").textContent=s("pirate200"),document.getElementById("pieceDescription10").textContent=s("warrior250"),document.getElementById("pieceDescription11").textContent=s("archer250"),document.getElementById("pieceDescription12").textContent=s("thief250"),document.getElementById("pieceDescription13").textContent=s("mage250"),document.getElementById("pieceDescription14").textContent=s("pirate250"),document.getElementById("pieceDescription15").textContent=s("xenon250"),I()&&(document.getElementById("pieceDescription16").textContent=s("enhancedLab200"),document.getElementById("pieceDescription17").textContent=s("enhancedLab250"),document.getElementById("pieceDescription18").textContent=s("lab250"))}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",E):E();let C=0,B=0;localStorage.getItem(v)&&(C=JSON.parse(localStorage.getItem(v)),document.getElementById("currentPiecesValue").innerText=`${C}`);let L=JSON.parse(localStorage.getItem(y));function P(){if(window._isUpdatingCurrentPieces)console.log("Already updating current pieces, preventing recursion");else{window._isUpdatingCurrentPieces=!0;try{console.log("Updating current pieces");const e=document.getElementById("boardButton")?.innerText||"",t=e&&e!==s("start"),n=t?localStorage.getItem(b):null;for(let e of w){const t=document.getElementById(`piece${e.id}`);t&&(e.amount=parseInt(t.value)||0)}C=(0,u.sumBy)(w,(e=>e.cellCount*e.amount)),B=(0,u.sumBy)(w,(e=>e.amount)),localStorage.setItem(y,JSON.stringify(w.map((e=>e.amount)))),localStorage.setItem(v,JSON.stringify(C)),localStorage.setItem("characterCount",JSON.stringify(B));const o=document.getElementById("currentPiecesValue");o&&(o.innerText=`${C}`);const r=document.getElementById("currentCaracterCountValue");if(r?r.innerText=`${B}`:console.log("Note: currentCaracterCountValue element not found - this is expected if the element was removed"),t&&n){console.log(`Preserving boardFilled value (${n}) in updateCurrentPieces`),localStorage.setItem(b,n);const e=document.getElementById("boardFilledValue");e&&(e.innerText=JSON.parse(n))}window._isSavingPreset||q()}finally{window._isUpdatingCurrentPieces=!1}}}L&&document.addEventListener("DOMContentLoaded",(()=>{for(let e=0;e<w.length;e++){const t=document.getElementById(`piece${e+1}`);t&&(t.value=L[e]||0)}P()})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("pieceForm");e&&e.addEventListener("input",P)})),window.pieces=w,window.currentPieces=C,window.currentUseCaracterCount=B,window.debugPieceIDs=function(){console.log("===== PIECE ID DEBUG ====="),console.log("Total pieces:",w.length),w.forEach(((e,t)=>{console.log(`Piece at index ${t}:`),console.log(`  ID: ${e.id}`),console.log(`  Cell Count: ${e.cellCount}`);const n=e.shape.map((e=>e.map((e=>0===e?"□":1===e?"■":"▣")).join(""))).join("\n");console.log(`  Shape:\n${n}`)})),console.log("===== END PIECE ID DEBUG =====")};const $={SELECTED_CHARACTERS:"legionSolver_selectedCharacters_preset_",BOARD_STATE:"legionBoard_preset_",BOARD_FILLED:"boardFilled_preset_",ACTIVE_PRESET:"legionSolver_activePreset",PIECE_AMOUNTS:"pieceAmounts",CURRENT_PIECES:"currentPieces"};let T=1;const D=[{id:1,name:"Hero",class:"warrior",level:250,legionEffect:"STR +",pieceIndex:9,icon:"⚔️"},{id:2,name:"Paladin",class:"warrior",level:250,legionEffect:"STR +",pieceIndex:9,icon:"🛡️"},{id:3,name:"Dark Knight",class:"warrior",level:250,legionEffect:"Max HP +%",pieceIndex:9,icon:"🔱"},{id:4,name:"Dawn Warrior",class:"warrior",level:250,legionEffect:"Max HP +%",pieceIndex:9,icon:"☀️"},{id:5,name:"Mihile",class:"warrior",level:250,legionEffect:"Max HP +",pieceIndex:9,icon:"🔆"},{id:6,name:"Blaster",class:"warrior",level:250,legionEffect:"IED +%",pieceIndex:9,icon:"💥"},{id:7,name:"Demon Slayer",class:"warrior",level:250,legionEffect:"Status Resistance +",pieceIndex:9,icon:"😈"},{id:8,name:"Demon Avenger",class:"warrior",level:250,legionEffect:"Boss DMG +%",pieceIndex:9,icon:"🔥"},{id:9,name:"Aran",class:"warrior",level:250,legionEffect:"70% chance to heal MAXHP +%",pieceIndex:9,icon:"❄️"},{id:44,name:"Hayato",class:"warrior",level:250,legionEffect:"Critical Damage +%",pieceIndex:9,icon:"⚔️"},{id:10,name:"Arch Mage (Fire/Poison)",class:"mage",level:250,legionEffect:"Max MP +%",pieceIndex:12,icon:"🔥"},{id:11,name:"Arch Mage (Ice/Lightning)",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"⚡"},{id:12,name:"Bishop",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"✝️"},{id:13,name:"Battle Mage",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"🧙‍♂️"},{id:14,name:"Luminous",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"☯️"},{id:15,name:"Evan",class:"mage",level:250,legionEffect:"70% chance to heal MAXMP +%",pieceIndex:12,icon:"🐉"},{id:16,name:"Illium",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"💎"},{id:17,name:"Kanna",class:"mage",level:250,legionEffect:"Boss DMG +%",pieceIndex:12,icon:"🌸"},{id:18,name:"Bowmaster",class:"archer",level:250,legionEffect:"DEX +",pieceIndex:10,icon:"🏹"},{id:19,name:"Marksman",class:"archer",level:250,legionEffect:"Critical Rate +%",pieceIndex:10,icon:"🎯"},{id:20,name:"Pathfinder",class:"archer",level:250,legionEffect:"DEX +",pieceIndex:10,icon:"⚱️"},{id:21,name:"Wind Archer",class:"archer",level:250,legionEffect:"DEX +",pieceIndex:10,icon:"🍃"},{id:22,name:"Wild Hunter",class:"archer",level:250,legionEffect:"Damage to Normal Monsters +%",pieceIndex:10,icon:"🐆"},{id:23,name:"Mercedes",class:"archer",level:250,legionEffect:"Skill Cooldown -%",pieceIndex:10,icon:"🧝‍♀️"},{id:24,name:"Night Lord",class:"thief",level:250,legionEffect:"Critical Rate +%",pieceIndex:11,icon:"🌑"},{id:25,name:"Shadower",class:"thief",level:250,legionEffect:"LUK +",pieceIndex:11,icon:"🗡️"},{id:26,name:"Dual Blade",class:"thief",level:250,legionEffect:"LUK +",pieceIndex:11,icon:"⚔️"},{id:27,name:"Night Walker",class:"thief",level:250,legionEffect:"LUK +",pieceIndex:11,icon:"🦇"},{id:28,name:"Phantom",class:"thief",level:250,legionEffect:"Meso Obtained +%",pieceIndex:11,icon:"♠️"},{id:29,name:"Cadena",class:"thief",level:250,legionEffect:"LUK +",pieceIndex:11,icon:"⛓️"},{id:30,name:"Hoyoung",class:"thief",level:250,legionEffect:"LUK +",pieceIndex:11,icon:"🦊"},{id:43,name:"Khali",class:"thief",level:250,legionEffect:"LUK +",pieceIndex:11,icon:"🥷"},{id:31,name:"Buccaneer",class:"pirate",level:250,legionEffect:"STR +",pieceIndex:13,icon:"👊"},{id:32,name:"Corsair",class:"pirate",level:250,legionEffect:"Summon Duration +%",pieceIndex:13,icon:"🔫"},{id:33,name:"Cannoneer",class:"pirate",level:250,legionEffect:"STR +",pieceIndex:13,icon:"💣"},{id:34,name:"Shade",class:"pirate",level:250,legionEffect:"Crit DMG +%",pieceIndex:13,icon:"👻"},{id:35,name:"Angelic Buster",class:"pirate",level:250,legionEffect:"DEX +",pieceIndex:13,icon:"💕"},{id:36,name:"Thunder Breaker",class:"pirate",level:250,legionEffect:"STR +",pieceIndex:13,icon:"⚡"},{id:37,name:"Mechanic",class:"pirate",level:250,legionEffect:"Buff Duration +%",pieceIndex:13,icon:"🤖"},{id:38,name:"Ark",class:"pirate",level:250,legionEffect:"STR +",pieceIndex:13,icon:"🐙"},{id:39,name:"Xenon",class:"special",level:250,legionEffect:"STR,DEX,LUK +",pieceIndex:14,icon:"🤖"},{id:40,name:"Zero",class:"warrior",level:250,legionEffect:"EXP +%",pieceIndex:9,icon:"⚔️"},{id:41,name:"Kinesis",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"🧠"},{id:42,name:"Adele",class:"warrior",level:250,legionEffect:"STR +",pieceIndex:9,icon:"⚔️"},{id:45,name:"Lynn",class:"mage",level:250,legionEffect:"IED +%",pieceIndex:12,icon:"🪄"},{id:46,name:"Lara",class:"mage",level:250,legionEffect:"INT +",pieceIndex:12,icon:"🌿"}];function N(){console.log("Initializing character selector"),setTimeout((()=>{if(!document.getElementById("characterSelector"))return void console.error("Character selector element not found");const e=document.querySelector(".filterContainer");if(e){e.innerHTML="";for(let t=1;t<=5;t++){const n=document.createElement("button");n.className="presetBtn",n.setAttribute("data-preset",t),n.textContent=`Preset ${t}`,n.onclick=function(){M(t)},e.appendChild(n)}console.log("Created 5 preset buttons")}else{console.error("Filter container not found, trying direct selection by ID");const e=document.getElementById("classCategories");if(e){e.innerHTML="";for(let t=1;t<=5;t++){const n=document.createElement("button");n.className="presetBtn",n.setAttribute("data-preset",t),n.textContent=`Preset ${t}`,n.onclick=function(){M(t)},e.appendChild(n)}console.log("Created 5 preset buttons using ID"),e.classList.contains("filterContainer")||e.classList.add("filterContainer")}else console.error("Could not find classCategories by ID either")}!function(){if(!D||0===D.length)return void console.error("Character data is missing or empty");console.log("Rendering character cards");const e=document.getElementById("characterSelector");if(!e)return console.error("Character selector element not found"),void setTimeout((()=>{const e=document.getElementById("characterSelector");e?(console.log("Character selector found after retry"),R(e)):console.error("Character selector still not found after retry")}),300);R(e)}(),F();const t=document.getElementById("clearPieces");t&&(t.onclick=function(){console.log("Clearing all selected pieces"),z(),j(),J(),q()});const n=localStorage.getItem($.ACTIVE_PRESET);n&&(T=parseInt(n)),A(),J(),setTimeout((()=>{U()}),100)}),200)}function A(){document.querySelectorAll(".presetBtn").forEach((e=>{e.classList.remove("active")}));const e=document.querySelector(`.presetBtn[data-preset="${T}"]`);e&&e.classList.add("active")}function F(){if(document.getElementById("pieceForm"))return;console.log("Creating hidden piece form");const e=document.createElement("div");e.id="pieceForm",e.style.display="none";const t=document.createElement("form");for(let e=1;e<=18;e++){const n=document.createElement("input");n.type="number",n.id=`piece${e}`,n.name=`piece${e}`,n.value="0",n.min="0",t.appendChild(n)}e.appendChild(t),document.body.appendChild(e),console.log("Hidden piece form created with inputs for pieces 1-18")}function M(e){console.log(`Switching to preset ${e}`),T!==e?(q(),T=e,localStorage.setItem($.ACTIVE_PRESET,T.toString()),A(),U(),O(e),"function"==typeof window.updateBoardDisplay&&(console.log("Using global updateBoardDisplay for comprehensive board update"),setTimeout((()=>{window.updateBoardDisplay()}),50))):console.log(`Already on preset ${e}, no action needed`)}function O(e){console.log(`Loading board state for preset ${e}`);const t=localStorage.getItem(`${$.BOARD_STATE}${e}`),n=localStorage.getItem(`${$.BOARD_FILLED}${e}`);if(t)localStorage.setItem("legionBoard",t),console.log(`Loaded board state for preset ${e}`);else{console.log(`No board state found for preset ${e}, creating new empty board`);const t=[];for(let e=0;e<20;e++){t[e]=[];for(let n=0;n<22;n++)t[e][n]=-1}const n=JSON.stringify(t);localStorage.setItem("legionBoard",n),localStorage.setItem(`${$.BOARD_STATE}${e}`,n)}if(n){localStorage.setItem("boardFilled",n);const t=document.getElementById("boardFilledValue");t&&(t.innerText=JSON.parse(n)),console.log(`Loaded board filled state (${n}) for preset ${e}`)}else{localStorage.setItem("boardFilled",JSON.stringify(0)),localStorage.setItem(`${$.BOARD_FILLED}${e}`,JSON.stringify(0));const t=document.getElementById("boardFilledValue");t&&(t.innerText="0"),console.log(`No board filled state found for preset ${e}, setting to 0`)}"function"==typeof window.updateBoardDisplay&&window.updateBoardDisplay()}function R(e){e.innerHTML="";const t=document.createElement("div");t.className="character-sections-container";const n={"STR +":"💪","DEX +":"🎯","INT +":"🧠","LUK +":"🍀","Max HP +%":"❤️","Max HP +":"❤️","Max MP +%":"💙","Max MP +":"💙","IED +%":"🛡️","Boss DMG +%":"👑","Crit Rate +%":"🎯","Crit DMG +%":"💥","Buff Duration +%":"⏱️","Skill Cooldown -%":"⚡","Summon Duration +%":"🧚","Damage to Normal Monsters +%":"👹","Meso Obtained +%":"💰","EXP +%":"📊","STR,DEX,LUK +%":"📈"},o={warrior:{title:"Warriors",characters:[]},mage:{title:"Mages",characters:[]},archer:{title:"Archers",characters:[]},thief:{title:"Thieves",characters:[]},pirate:{title:"Pirates",characters:[]},special:{title:"Special Classes",characters:[]}};D.forEach((e=>{o[e.class]?o[e.class].characters.push(e):console.warn(`Unknown character class: ${e.class}`)})),Object.values(o).forEach((e=>{if(0===e.characters.length)return;const o=document.createElement("div");o.className="character-section";const r=document.createElement("div");r.className="character-section-header",r.innerHTML=`\n            <span>${e.title}</span>\n            <span class="section-toggle">▼</span>\n        `,o.appendChild(r);const a=document.createElement("div");a.className="character-cards-container",e.characters.forEach((e=>{const t=document.createElement("div");t.className="characterCard",t.dataset.id=e.id,t.dataset.class=e.class;const o=e.legionEffect,r=n[o]||"🔮";t.innerHTML=`\n                <div class="characterName">${e.name}</div>\n                <div class="characterClass">\n                    <span class="effect-icon">${r}</span>\n                    <span class="effect-text">${o}</span>\n                </div>\n            `,t.onclick=function(){console.log("Character card clicked:",e.name),function(e){console.log("Selecting character:",e.name);const t=document.getElementById("characterDetailsContent");if(!t)return void console.error("Character details content element not found");const n={warrior:{60:1,100:2,140:3,200:5,250:10},mage:{60:1,100:2,140:4,200:8,250:13},archer:{60:1,100:2,140:4,200:6,250:11},thief:{60:1,100:2,140:4,200:7,250:12},pirate:{60:1,100:2,140:3,200:9,250:14},special:{60:1,100:2,140:4,200:8,250:15}};window.levelToPieceIndex=n;const o=[60,100,140,200,250].map((t=>`\n            <label class="level-radio">\n                <input type="radio" name="level" value="${t}" data-piece-index="${n[e.class][t]||1}" ${250===t?"checked":""}>\n                <span>Lvl ${t}</span>\n            </label>\n        `)).join("");t.innerHTML=`\n        <div class="characterDetailCard" data-class="${e.class}">\n            <h4>${e.name}</h4>\n            <p><strong>Class:</strong> ${e.class.charAt(0).toUpperCase()+e.class.slice(1)}</p>\n            <p><strong>Legion Effect:</strong> ${e.legionEffect}</p>\n            \n            <div class="level-selection">\n                <p><strong>Select Character Level:</strong></p>\n                <div class="level-options">\n                    ${o}\n                </div>\n            </div>\n            \n            <button id="addCharacterBtn">Add to Board</button>\n        </div>\n    `;const r=document.getElementById("addCharacterBtn");r&&(r.onclick=function(){const t=document.querySelector('input[name="level"]:checked'),n=t?parseInt(t.value):250,o=t?parseInt(t.dataset.pieceIndex):e.pieceIndex;console.log("Adding character to board:",e.name,"Level:",n,"Piece Index:",o),function(e){console.log("Adding character to piece selection:",e.name,"Level:",e.level,"Piece Index:",e.pieceIndex);const t=document.getElementById("boardButton"),n={boardFilled:localStorage.getItem($.BOARD_FILLED),boardState:localStorage.getItem($.BOARD_STATE),solverState:t?.innerText||""},o=n.solverState&&n.solverState!==s("start");console.log("Current board state:",`Filled spaces: ${n.boardFilled||0}, `,`Solver state: ${n.solverState}, `,`Is after start: ${o}`);const r=document.getElementById("pieceSelectionContent");if(!r)return void console.error("Piece selection content element not found");const a=`${e.id}-${e.level}`;if(document.querySelector(`.selectedPiece[data-unique-id="${a}"]`))return void console.log("Character already selected at this level");const i=document.createElement("div");i.className=`selectedPiece ${((e,t)=>{let n="";switch(t){case"warrior":n="warrior-color";break;case"mage":n="mage-color";break;case"archer":n="archer-color";break;case"thief":n="thief-color";break;case"pirate":n="pirate-color";break;case"special":n="special-color";break;default:n=""}let o="";switch(e){case 1:o="piece-lvl60";break;case 2:o="piece-lvl100";break;case 3:o="piece-lvl140-warrior-pirate";break;case 4:o="piece-lvl140-mage-thief-archer";break;case 5:o="piece-lvl200-warrior";break;case 6:o="piece-lvl200-archer";break;case 7:o="piece-lvl200-thief-lab";break;case 8:o="piece-lvl200-mage";break;case 9:o="piece-lvl250-warrior";break;case 10:o="piece-lvl250-archer";break;case 11:o="piece-lvl250-thief";break;case 12:o="piece-lvl250-mage";break;case 13:o="piece-lvl250-pirate";break;case 14:o="piece-lvl250-xenon";break;case 15:case 16:case 17:case 18:o="piece-lab-enhanced";break;default:o=""}return`${o} ${n}`})(e.pieceIndex,e.class)}`,i.dataset.id=e.id,i.dataset.uniqueId=a,i.dataset.pieceIndex=e.pieceIndex,i.dataset.level=e.level,i.dataset.characterClass=e.class,i.innerHTML=`\n        <div class="selectedPieceInfo">\n            <span class="characterName">${e.name}</span>\n            <span class="characterLevel">Lvl ${e.level}</span>\n        </div>\n        <button class="removePieceBtn">×</button>\n    `;const l=i.querySelector(".removePieceBtn");l&&(l.onclick=function(){console.log("Removing character:",e.name,"Level:",e.level),i.remove(),j(),W(e.id,!1),J(),q()});const c=o&&n.boardFilled?JSON.parse(n.boardFilled):0;if(r.appendChild(i),j(),W(e.id,!0),J(),q(),o&&n.boardFilled){console.log(`Restoring board state after adding character during solving: ${c}`),localStorage.setItem($.BOARD_FILLED,JSON.stringify(c));const e=document.getElementById("boardFilledValue");e&&(e.innerText=c.toString(),console.log(`Restored boardFilled display to ${c}`)),"function"==typeof window.updatePiecesForSolver&&setTimeout((()=>{console.log("Calling updatePiecesForSolver to verify board state"),window.updatePiecesForSolver()}),100)}}({...e,level:n,pieceIndex:o})})}(e)},a.appendChild(t)})),o.appendChild(a),r.addEventListener("click",(function(e){if(e.target.closest(".characterCard"))return;const t="none"!==a.style.display;a.style.display=t?"none":"grid";const n=r.querySelector(".section-toggle");n&&(n.textContent=t?"▶":"▼")})),t.appendChild(o)})),e.appendChild(t),console.log("Characters rendered by class sections")}function J(){const e=document.querySelectorAll(".selectedPiece"),t=document.getElementById("selectedCharactersCount");t&&(t.textContent=`(${e.length})`)}function W(e,t){const n=document.querySelector(`.characterCard[data-id="${e}"]`);n&&(t?n.classList.add("selected"):n.classList.remove("selected"))}function j(){if(console.log("Updating piece amounts"),window._isUpdatingPieces)console.log("Already updating pieces, preventing recursive call");else{window._isUpdatingPieces=!0;try{const e=document.getElementById("boardButton"),t=e?.innerText||"",n=t&&t!==s("start");let o=null;n&&(o=localStorage.getItem($.BOARD_FILLED),console.log(`Solver is in ${t} state, preserving boardFilled: ${o}`)),document.getElementById("pieceForm")||F();for(let e=1;e<=18;e++){const t=document.getElementById(`piece${e}`);if(t)t.value=0;else{console.warn(`Piece input element for piece${e} not found`);const t=document.querySelector("#pieceForm form");if(t){const n=document.createElement("input");n.type="number",n.id=`piece${e}`,n.name=`piece${e}`,n.value="0",n.min="0",t.appendChild(n),console.log(`Created missing piece input: piece${e}`)}}}const r={};let a=0,i=0;document.querySelectorAll(".selectedPiece").forEach((e=>{const t=parseInt(e.dataset.pieceIndex);r[t]=(r[t]||0)+1,a++;const n=parseInt(e.dataset.level)||250;let o=1;60===n?o=1:100===n?o=2:140===n?o=3:200===n?o=4:250===n&&(o=5),i+=o})),console.log("Piece counts by index:",r),console.log("Total characters:",a),console.log("Total pieces (cells):",i);for(const[e,t]of Object.entries(r)){const n=document.getElementById(`piece${e}`);n?(n.value=t,console.log(`Updated piece${e} to ${t}`)):console.warn(`Piece input element for piece${e} not found`)}if(n&&o){console.log(`Restoring boardFilled value (${o}) after character update`),localStorage.setItem($.BOARD_FILLED,o);const e=document.getElementById("boardFilledValue");e&&(e.innerText=JSON.parse(o))}"function"==typeof window.updateCurrentPieces&&window.updateCurrentPieces()}finally{window._isUpdatingPieces=!1}}}function q(){if(window._isSavingState)console.log("Already saving state, preventing recursion");else{window._isSavingState=!0;try{console.log(`Saving current state to localStorage for preset ${T}`);const e=[];document.querySelectorAll(".selectedPiece").forEach((t=>{e.push({characterId:parseInt(t.dataset.id),level:parseInt(t.dataset.level),pieceIndex:parseInt(t.dataset.pieceIndex),uniqueId:t.dataset.uniqueId})})),localStorage.setItem(`${$.SELECTED_CHARACTERS}${T}`,JSON.stringify(e)),function(){console.log(`Saving board state for preset ${T}`);const e=localStorage.getItem("legionBoard"),t=localStorage.getItem("boardFilled");e?(localStorage.setItem(`${$.BOARD_STATE}${T}`,e),console.log(`Saved board layout for preset ${T}`)):(localStorage.removeItem(`${$.BOARD_STATE}${T}`),console.log(`Removed board layout for preset ${T}`)),t?(localStorage.setItem(`${$.BOARD_FILLED}${T}`,t),console.log(`Saved board filled count (${t}) for preset ${T}`)):(localStorage.removeItem(`${$.BOARD_FILLED}${T}`),console.log(`Removed board filled count for preset ${T}`))}(),console.log(`Saved ${e.length} characters to localStorage for preset ${T}`)}catch(e){console.error("Error saving state to localStorage:",e)}finally{window._isSavingState=!1}}}function U(){console.log(`Loading saved state from localStorage for preset ${T}`);try{z();const e=localStorage.getItem(`${$.SELECTED_CHARACTERS}${T}`);if(e){const t=JSON.parse(e);t&&t.length>0?(console.log(`Found ${t.length} saved characters for preset ${T}`),t.forEach((e=>{const t=D.find((t=>t.id===e.characterId));t&&function(e){console.log("Adding saved character:",e.name,"Level:",e.level);const t=document.getElementById("pieceSelectionContent");if(!t)return void console.error("Piece selection content element not found");const n=`${e.id}-${e.level}`;if(document.querySelector(`.selectedPiece[data-unique-id="${n}"]`))return void console.log("Character already selected at this level");const o=document.createElement("div");o.className=`selectedPiece ${((e,t)=>{let n="";switch(t){case"warrior":n="warrior-color";break;case"mage":n="mage-color";break;case"archer":n="archer-color";break;case"thief":n="thief-color";break;case"pirate":n="pirate-color";break;case"special":n="special-color";break;default:n=""}let o="";switch(e){case 1:o="piece-lvl60";break;case 2:o="piece-lvl100";break;case 3:o="piece-lvl140-warrior-pirate";break;case 4:o="piece-lvl140-mage-thief-archer";break;case 5:o="piece-lvl200-warrior";break;case 6:o="piece-lvl200-archer";break;case 7:o="piece-lvl200-thief-lab";break;case 8:o="piece-lvl200-mage";break;case 9:o="piece-lvl250-warrior";break;case 10:o="piece-lvl250-archer";break;case 11:o="piece-lvl250-thief";break;case 12:o="piece-lvl250-mage";break;case 13:o="piece-lvl250-pirate";break;case 14:o="piece-lvl250-xenon";break;case 15:case 16:case 17:case 18:o="piece-lab-enhanced";break;default:o=""}return`${o} ${n}`})(e.pieceIndex,e.class)}`,o.dataset.id=e.id,o.dataset.uniqueId=n,o.dataset.pieceIndex=e.pieceIndex,o.dataset.level=e.level,o.dataset.characterClass=e.class,o.innerHTML=`\n        <div class="selectedPieceInfo">\n            <span class="characterName">${e.name}</span>\n            <span class="characterLevel">Lvl ${e.level}</span>\n        </div>\n        <button class="removePieceBtn">×</button>\n    `;const r=o.querySelector(".removePieceBtn");r&&(r.onclick=function(){console.log("Removing character:",e.name,"Level:",e.level),o.remove(),j(),W(e.id,!1),J(),q()}),t.appendChild(o),W(e.id,!0),J()}({...t,level:e.level,pieceIndex:e.pieceIndex})})),j(),J()):(console.log("No saved characters found for this preset"),H())}else console.log("No saved character state found for this preset"),H();O(T)}catch(e){console.error("Error loading state from localStorage:",e)}}function z(){const e=document.getElementById("pieceSelectionContent");e&&(e.innerHTML=""),document.querySelectorAll(".characterCard.selected").forEach((e=>{e.classList.remove("selected")})),J()}function V(){if(window._isSavingPreset)console.log("Already saving preset, preventing recursive call");else{window._isSavingPreset=!0;try{j(),q()}finally{window._isSavingPreset=!1}}}function H(){console.log("Resetting all piece amounts to zero");for(let e=1;e<=18;e++){const t=document.getElementById(`piece${e}`);t&&(t.value=0)}if(z(),window.pieces)for(let e of window.pieces)e.amount=0;const e=document.getElementById("currentPiecesValue");e&&(e.innerText="0");const t=document.getElementById("currentCaracterCountValue");t?t.innerText="0":console.log("Note: currentCaracterCountValue element not found - this is expected if the element was removed"),localStorage.setItem($.PIECE_AMOUNTS,JSON.stringify(Array(18).fill(0))),localStorage.setItem($.CURRENT_PIECES,JSON.stringify(0)),localStorage.setItem("characterCount",JSON.stringify(0)),setTimeout((()=>{"function"==typeof window.updateCurrentPieces&&window.updateCurrentPieces()}),0)}function K(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.charactersData=D,window.updatePieceAmounts=j,"complete"===document.readyState||"interactive"===document.readyState?setTimeout(N,300):document.addEventListener("DOMContentLoaded",(function(){setTimeout(N,300)})),window.debugCharacterSelector=function(){console.log("=== Character Selection Debug Information ==="),console.log(`Active Preset: ${T}`);const e=document.querySelectorAll(".characterCard"),t={};e.forEach((e=>{const n=e.getAttribute("data-class");t[n]=(t[n]||0)+1})),console.log(`Total character cards: ${e.length}`),console.log("Character counts by class:",t);const n=document.querySelectorAll(".presetBtn");console.log(`Total preset buttons: ${n.length}`),console.log("Preset buttons:",Array.from(n).map((e=>e.getAttribute("data-preset"))));const o=document.querySelector(".presetBtn.active");o?console.log("Active preset button:",o.getAttribute("data-preset")):console.log("No active preset button found");const r=document.querySelectorAll(".selectedPiece");console.log(`Total selected pieces: ${r.length}`),r.length>0&&(console.log("Selected pieces details:"),r.forEach((e=>{const t=e.getAttribute("data-id"),n=e.getAttribute("data-piece-index"),o=e.getAttribute("data-level");if(console.log(`- ID: ${t}, Piece Index: ${n}, Level: ${o}`),window.pieces&&n>0&&n<=window.pieces.length){const e=n-1;window.pieces[e]&&window.pieces[e].shape&&(console.log("  Shape:"),window.pieces[e].shape.forEach((e=>{let t="  ";e.forEach((e=>{t+=0===e?"□ ":"■ "})),console.log(t)})))}}))),console.log("=== Preset Storage Debug ===");for(let e=1;e<=5;e++){const t=`${$.SELECTED_CHARACTERS}${e}`,n=`${$.BOARD_STATE}${e}`,o=`${$.BOARD_FILLED}${e}`,r=localStorage.getItem(t),a=localStorage.getItem(n),i=localStorage.getItem(o);console.log(`Preset ${e}:`),console.log("- Characters: "+(r?JSON.parse(r).length+" characters":"None")),console.log("- Board State: "+(a?"Saved":"None")),console.log(`- Board Filled: ${i||"None"}`)}if(window.pieces){console.log("=== Pieces Array Debug ==="),console.log(`Total piece types: ${window.pieces.length}`);let e=0;window.pieces.forEach(((t,n)=>{t.amount>0&&(e+=t.amount,console.log(`Piece #${n+1} (${function(e){switch(e){case 1:return"Level 60 (All classes)";case 2:return"Level 100 (All classes)";case 3:return"Level 140 Warrior/Pirate";case 4:return"Level 140 Mage/Thief/Archer";case 5:return"Level 200 Warrior";case 6:return"Level 200 Archer";case 7:return"Level 200 Thief/Lab";case 8:return"Level 200 Mage";case 9:return"Level 250 Warrior";case 10:return"Level 250 Archer";case 11:return"Level 250 Thief";case 12:return"Level 250 Mage";case 13:return"Level 250 Pirate";case 14:return"Level 250 Xenon";case 15:return"Level 200 Enhanced Lab";case 16:return"Level 250 Enhanced Lab";case 17:return"Level 250 Lab";default:return`Unknown piece type (${e})`}}(n+1)}):`),console.log(`  Amount: ${t.amount}`),console.log("  Shape:"),t.shape.forEach((e=>{let t="  ";e.forEach((e=>{t+=0===e?"□ ":"■ "})),console.log(t)})))})),console.log(`Total pieces used: ${e}`)}else console.log("Pieces array not found! The solver will not work correctly.")};class X{constructor(e,t,n){K(this,"pausePromise",void 0),K(this,"pauseResolve",void 0),K(this,"iterations",void 0),K(this,"directionFree",void 0),K(this,"success",void 0),K(this,"shouldStop",void 0),this.board=e,this.pieces=t,this.onBoardUpdated=n,this.iterations=0,this.pieceLength=t.length,this.valid=!0,this.pieceNumber=0,this.transformationNumber=0,this.restrictedPieceNumber=0,this.restrictedTransformationNumber=0,this.time=(new Date).getTime(),this.history=[],this.middle=[];for(let e=this.board.length/2-1;e<this.board.length/2+1;e++)for(let t=this.board[0].length/2-1;t<this.board[0].length/2+1;t++)-1!=this.board[e][t]&&this.middle.push(new p(t,e));this.emptySpots=[];for(let e=0;e<this.board.length;e++)for(let t=0;t<this.board[0].length;t++)0==this.board[e][t]&&this.emptySpots.push(new p(t,e));this.restrictedSpots=[];for(let e=0;e<this.board.length;e++)for(let t=0;t<this.board[0].length;t++)this.searchSurroundings(t,e);this.longSpaces=[];for(let e=0;e<this.board.length;e++)for(let t=0;t<this.board[0].length;t++)"horizontal"==this.checkLongSpace(t,e)&&this.longSpaces.push(new p(t,e)),"vertical"==this.checkLongSpace(t,e)&&this.longSpaces.push(new p(t,e));this.firstAlgorithm=!!this.longSpaces.length}async solve(){return this.pieces.sort(((e,t)=>t.amount*t.cellCount-e.amount*e.cellCount)),this.pieces.push(new m([[]],0,-1)),this.restrictedSpots.sort(((e,t)=>t.spotsFilled-e.spotsFilled)),this.time=(new Date).getTime(),this.success=await this.solveInternal(),this.success}async solveInternal(e=3e4){let t,n,o,r=[],a=0;for(;a<this.emptySpots.length&&0!=this.board[this.emptySpots[a].y][this.emptySpots[a].x];)a++;for(;this.pieces[0].amount>0||!this.valid;){if(this.shouldStop)return;if(this.valid&&0!=this.restrictedSpots.length&&this.pieces[this.restrictedPieceNumber].amount&&5!=this.directionFree&&!this.firstAlgorithm)this.restrictedPieceNumber!=this.pieceLength&&(o=this.restrictedSpots[0],n=this.pieces[this.restrictedPieceNumber].restrictedTransformations[this.restrictedTransformationNumber],this.determineDirectionFree(o),this.isPlaceable(o,n)?(r.push([0,0,this.takeFromList(this.restrictedPieceNumber),[...this.restrictedSpots],o,this.restrictedPieceNumber,this.restrictedTransformationNumber,this.directionFree,[],0,this.valid]),this.restrictedSpots.splice(0,1),this.placePiece(o,n),this.isValid(),this.restrictedPieceNumber=0,this.restrictedTransformationNumber=0):this.changeIndex(!0));else if(this.valid&&this.pieces[this.pieceNumber].amount&&(this.firstAlgorithm||0==this.restrictedSpots.length)&&5!=this.directionFree){if(this.directionFree=0,!this.firstAlgorithm)for(a=0;a<this.emptySpots.length&&0!=this.board[this.emptySpots[a].y][this.emptySpots[a].x];)a++;if(a==this.emptySpots.length)return!0;if(o=this.emptySpots[a],n=this.pieces[this.pieceNumber].transformations[this.transformationNumber],this.isPlaceable(o,n)){let e=[];for(let t=0;t<this.longSpaces.length;t++)e.push(this.longSpaces[t]);if(r.push([this.pieceNumber,this.transformationNumber,this.takeFromList(this.pieceNumber),[...this.restrictedSpots],o,0,0,0,e,a,this.valid]),this.placePiece(o,n),this.isValid(),this.firstAlgorithm){for(;a<this.emptySpots.length&&0!=this.board[this.emptySpots[a].y][this.emptySpots[a].x];)a++;if(a==this.emptySpots.length)return!0}this.pieceNumber=0,this.transformationNumber=0}else this.changeIndex(!1)}else{if(0==r.length)return!1;this.valid||(this.valid=!0),[this.pieceNumber,this.transformationNumber,t,this.restrictedSpots,o,this.restrictedPieceNumber,this.restrictedTransformationNumber,this.directionFree,this.longSpaces,a,this.valid]=r.pop(),0==this.directionFree?(this.returnToList(this.pieceNumber,t),this.takeBackPiece(o,this.pieces[this.pieceNumber].transformations[this.transformationNumber])):(this.returnToList(this.restrictedPieceNumber,t),this.takeBackPiece(o,this.pieces[this.restrictedPieceNumber].restrictedTransformations[this.restrictedTransformationNumber])),this.firstAlgorithm=!(0==this.longSpaces.length),this.firstAlgorithm?this.changeIndex(!1):this.changeIndex(0==!this.restrictedSpots.length)}this.iterations++,this.iterations%e==0&&(this.onBoardUpdated(),await new Promise((e=>setTimeout(e,0))),this.pausePromise&&await this.pausePromise)}return!0}takeFromList(e){this.pieces[e].amount--;let t=this.pieces[e],n=e+1;for(;t.amount*t.cellCount<this.pieces[n].amount*this.pieces[n].cellCount;)n++;return this.pieces[e]=this.pieces[n-1],this.pieces[n-1]=t,n-1-e}returnToList(e,t){let n=this.pieces[e];this.pieces[e]=this.pieces[e+t],this.pieces[e+t]=n,this.pieces[e].amount++}isValid(){if(0==this.middle.length)return!0;let e=0;for(let t of this.middle)this.board[t.y][t.x]>0&&this.board[t.y][t.x]<=this.pieceLength&&e++;this.valid=e!=this.middle.length}isPlaceable(e,t){if(!t)return!1;for(let n of t.pointShape){let o,r;if([o,r]=this.determinePoint(e,t,n),r>=this.board.length||r<0||o>=this.board[0].length||o<0||0!=this.board[r][o])return!1}return!0}placePiece(e,t){let n=[];this.history[this.history.length]=[];for(let o of t.pointShape){let r,a;[r,a]=this.determinePoint(e,t,o),o.isMiddle?this.board[a][r]=t.id+18:this.board[a][r]=t.id,n.push(new p(r,a)),this.history[this.history.length-1].push(new p(r,a));for(let e=0;e<this.restrictedSpots.length;e++)this.restrictedSpots[e].x==r&&this.restrictedSpots[e].y==a&&(this.restrictedSpots.splice(e,1),e--);for(let e=0;e<this.longSpaces.length;e++)this.longSpaces[e].x==r&&this.longSpaces[e].y==a&&(this.longSpaces.splice(e,1),e--);0==this.longSpaces.length&&(this.firstAlgorithm=!1)}for(let e of n)this.searchSurroundings(e.x,e.y+1),this.searchSurroundings(e.x,e.y-1),this.searchSurroundings(e.x+1,e.y),this.searchSurroundings(e.x-1,e.y);let o=[];for(let e=0;e<this.restrictedSpots.length-1;e++)for(let t=e+1;t<this.restrictedSpots.length;t++)this.restrictedSpots[e].x==this.restrictedSpots[t].x&&this.restrictedSpots[e].y==this.restrictedSpots[t].y&&o.push(e);for(let e=o.length-1;e>=0;e--)this.restrictedSpots.splice(o[e],1);this.restrictedSpots.sort(((e,t)=>t.spotsFilled-e.spotsFilled))}takeBackPiece(e,t){this.history.pop();for(let n of t.pointShape){let o,r;[o,r]=this.determinePoint(e,t,n),this.board[r][o]=0}}searchSurroundings(e,t){let n=0;this.board[t]&&0==this.board[t][e]&&(this.board[t+1]&&0==this.board[t+1][e]&&n++,this.board[t-1]&&0==this.board[t-1][e]&&n++,this.board[t]&&0==this.board[t][e+1]&&n++,this.board[t]&&0==this.board[t][e-1]&&n++,n<=1&&this.restrictedSpots.push(new G(e,t,4-n)))}checkLongSpace(e,t){return this.board[t+1]&&0==this.board[t+1][e]&&this.board[t-1]&&0==this.board[t-1][e]&&this.board[t]&&0!=this.board[t][e+1]&&this.board[t]&&0!=this.board[t][e-1]?"vertical":this.board[t+1]&&0!=this.board[t+1][e]&&this.board[t-1]&&0!=this.board[t-1][e]&&this.board[t]&&0==this.board[t][e+1]&&this.board[t]&&0==this.board[t][e-1]?"horizontal":void 0}changeIndex(e){e?this.restrictedTransformationNumber<this.pieces[this.restrictedPieceNumber].restrictedTransformations.length-1?this.restrictedTransformationNumber++:(this.restrictedPieceNumber++,this.restrictedTransformationNumber=0):this.transformationNumber<this.pieces[this.pieceNumber].transformations.length-1?this.transformationNumber++:(this.pieceNumber++,this.transformationNumber=0)}determineDirectionFree(e){this.board[e.y-1]&&0==this.board[e.y-1][e.x]?this.directionFree=1:this.board[e.y]&&0==this.board[e.y][e.x+1]?this.directionFree=2:this.board[e.y+1]&&0==this.board[e.y+1][e.x]?this.directionFree=3:this.board[e.y]&&0==this.board[e.y][e.x-1]?this.directionFree=4:this.directionFree=5}determinePoint(e,t,n){let o,r;return 0==this.directionFree||3==this.directionFree||5==this.directionFree?(o=e.x+n.x-t.offCenter,r=e.y+n.y):1==this.directionFree?(o=e.x-n.x+t.offCenter,r=e.y-n.y):2==this.directionFree?(o=e.x+n.y,r=e.y+n.x-t.offCenter):(o=e.x-n.y,r=e.y-n.x+t.offCenter),[o,r]}pause(){this.time-=(new Date).getTime(),0!=this.iterations&&(document.getElementById("iterations").style.visibility="visible",document.getElementById("iterationsValue").innerText=`${this.iterations}`,document.getElementById("time").style.visibility="visible",document.getElementById("timeValue").innerText=-this.time+"ms"),this.pausePromise=new Promise((e=>this.pauseResolve=e))}continue(){this.time+=(new Date).getTime(),document.getElementById("iterations").style.visibility="hidden",document.getElementById("time").style.visibility="hidden",this.pauseResolve(),this.pausePromise=null}stop(){this.shouldStop=!0}verifyPieceTransformations(e){if(e<0||e>=this.pieces.length)return!1;const t=this.pieces[e].transformations;console.log(`Piece #${e+1} has ${t.length} transformations`);for(let e=0;e<t.length;e++){const n=t[e].pointShape;console.log(`  Transformation #${e+1}: ${n.length} points`)}return t.length>0}}class G extends p{constructor(e,t,n){super(e,t),this.spotsFilled=n}}const Y="legionBoard_preset_",Z="boardFilled_preset_",Q="legionSolver_activePreset";let ee=localStorage.getItem(Q)?parseInt(localStorage.getItem(Q)):1,te=`${Y}${ee}`,ne=JSON.parse(localStorage.getItem(te));if(ne)console.log(`Loaded existing board for preset ${ee}`),localStorage.setItem("legionBoard",JSON.stringify(ne));else{console.log(`Initializing new board for preset ${ee}`),ne=[];for(let e=0;e<20;e++){ne[e]=[];for(let t=0;t<22;t++)ne[e][t]=-1}localStorage.setItem(te,JSON.stringify(ne)),localStorage.setItem("legionBoard",JSON.stringify(ne))}let oe=`${Z}${ee}`,re=localStorage.getItem(oe)?JSON.parse(localStorage.getItem(oe)):0;localStorage.setItem("boardFilled",JSON.stringify(re)),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("boardFilledValue");e&&(e.innerText=re)}));let ae=[],ie=[];const le="start",ce="running",se="paused",de="completed";let pe=le;const ge=[];for(let e=0;e<16;e++)ge[e]=[];document.querySelector("#legionBoard tbody").innerHTML=ne.map((e=>`<tr>${e.map((e=>'<td class="legionCell"></td>')).join("")}</tr>`)).join(""),ke(),function(){for(let e=0;e<ne.length/4;e++)for(let t=e;t<ne.length/2;t++)ge[0].push(new p(t,e)),ge[1].push(new p(e,t+1)),ge[2].push(new p(e,ne[0].length-2-t)),ge[3].push(new p(t,ne[0].length-1-e)),ge[4].push(new p(ne.length-1-t,ne[0].length-1-e)),ge[5].push(new p(ne.length-1-e,ne[0].length-2-t)),ge[6].push(new p(ne.length-1-e,t+1)),ge[7].push(new p(ne.length-1-t,e));for(let e=ne.length/4;e<ne.length/2;e++)for(let t=e;t<ne.length/2;t++)ge[8].push(new p(t,e)),ge[9].push(new p(e,t+1)),ge[10].push(new p(3*ne.length/4-1-t,ne.length/4+1+e)),ge[11].push(new p(t,ne[0].length-1-e)),ge[12].push(new p(ne.length-1-t,ne[0].length-1-e)),ge[13].push(new p(t+ne.length/4,e+ne.length/4+1)),ge[14].push(new p(t+ne.length/4,3*ne.length/4-e)),ge[15].push(new p(ne.length-t-1,e))}();for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++)0===ne[e][t]&&re++;localStorage.setItem(oe,JSON.stringify(re)),document.getElementById("boardFilledValue").innerText=`${re}`,window.updateBoardDisplay=function(){console.log("Updating board display"),ee=localStorage.getItem(Q)?parseInt(localStorage.getItem(Q)):1;const e=`${Y}${ee}`,t=`${Z}${ee}`;let n=localStorage.getItem(e);if(n||(console.log(`No board state found for preset ${ee}, checking standard key`),n=localStorage.getItem("legionBoard")),n){ne=JSON.parse(n),console.log(`Loaded board state for preset ${ee}`),localStorage.setItem("legionBoard",n),re=0;for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++)0===ne[e][t]&&re++;localStorage.setItem(t,JSON.stringify(re)),localStorage.setItem("boardFilled",JSON.stringify(re));for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++){const n=xe(e,t);n&&(n.style.background=k.get(ne[e][t]))}const e=document.getElementById("boardFilledValue");e&&(e.innerText=`${re}`),ke()}else{console.error("No board state found when updating display"),ne=[];for(let e=0;e<20;e++){ne[e]=[];for(let t=0;t<22;t++)ne[e][t]=-1}re=0,localStorage.setItem(e,JSON.stringify(ne)),localStorage.setItem("legionBoard",JSON.stringify(ne)),localStorage.setItem(t,JSON.stringify(0)),localStorage.setItem("boardFilled",JSON.stringify(0));const n=document.getElementById("boardFilledValue");n&&(n.innerText="0");for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++){const n=xe(e,t);n&&(n.style.background=k.get(ne[e][t]))}ke()}};let he=!1;localStorage.getItem("isBigClick")&&(document.getElementById("bigClick").checked=JSON.parse(localStorage.getItem("isBigClick")),JSON.parse(localStorage.getItem("isBigClick"))&&Be());let ue=!1;localStorage.getItem("isLiveSolve")&&(document.getElementById("liveSolve").checked=JSON.parse(localStorage.getItem("isLiveSolve")),JSON.parse(localStorage.getItem("isLiveSolve"))&&Le()),document.getElementById("bigClick").addEventListener("click",Be),document.getElementById("liveSolve").addEventListener("click",Le),document.getElementById("clearBoard").addEventListener("click",(function(){console.log(`Clearing board for preset ${ee}`),ee=localStorage.getItem(Q)?parseInt(localStorage.getItem(Q)):1;for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++){ne[e][t]=-1;const n=xe(e,t);n&&(n.style.background=k.get(ne[e][t]))}re=0;const e=`${Y}${ee}`,t=`${Z}${ee}`;localStorage.setItem(e,JSON.stringify(ne)),localStorage.setItem("legionBoard",JSON.stringify(ne)),localStorage.setItem(t,JSON.stringify(0)),localStorage.setItem("boardFilled",JSON.stringify(0));const n=document.getElementById("boardFilledValue");n&&(n.innerText="0"),ke(),V(),console.log(`Board cleared for preset ${ee}`)})),document.getElementById("boardButton").addEventListener("click",(async function(e){switch(pe){case le:e.target.innerText=s("pause"),document.getElementById("clearBoard").disabled=!0,pe=ce,await async function(){if(0==re&&currentPieces>0)return!1;console.log("Ensuring pieces array is updated before solving...");const e=document.querySelectorAll(".selectedPiece"),t={};console.log(`Found ${e.length} selected pieces:`),e.forEach((e=>{const n=e.querySelector(".characterName")?.textContent||"Unknown",o=e.querySelector(".characterLevel")?.textContent||"Unknown",r=e.getAttribute("data-character-class")||e.dataset.characterClass||"unknown",a=parseInt(e.getAttribute("data-piece-index")||e.dataset.pieceIndex)||0;console.log(`- ${n} (${r} ${o}): Using piece index ${a}`),t[a]=(t[a]||0)+1})),w.forEach((e=>{e&&"object"==typeof e&&(e.amount=0)})),console.log("Updating piece amounts and visualizing shapes:");for(const[e,n]of Object.entries(t)){const t=parseInt(e)-1;if(t>=0&&t<w.length&&w[t])if(w[t].amount=n,console.log(`Piece #${e} (amount: ${n}):`),w[t].shape){const e=[];if(w[t].shape.forEach((t=>{let n="  ";t.forEach((e=>{n+=0===e?"□ ":1===e?"■ ":"▣ "})),e.push(n)})),console.log(e.join("\n")),w[t].pointShape){console.log(`  Point shape (${w[t].pointShape.length} points):`);const e=w[t].pointShape.map((e=>`    (${e.x},${e.y})${e.isMiddle?" [middle]":""}`)).join("\n");console.log(e)}}else console.warn(`  No shape defined for piece #${e}`);else console.warn(`Piece index ${e} (${t} in array) is out of range. Array length: ${w.length}`)}"function"==typeof window.updatePiecesForSolver&&window.updatePiecesForSolver();let n=!1;if(w.forEach(((e,t)=>{e.amount>0&&(console.log(`Piece ${t+1} amount:`,e.amount),n=!0)})),!n)return console.error("No pieces were selected! Make sure pieces are being added correctly."),alert("No pieces were selected! Please select at least one character piece."),!1;let o=!1;for(let e=0;e<ne.length;e++){for(let t=0;t<ne[0].length;t++)if(0===ne[e][t]){o=!0;break}if(o)break}if(!o)return console.error("No spaces were selected on the board! You need to fill in some spaces."),alert("No spaces were filled on the board! Click on the grid to fill some spaces."),!1;console.log("==================================");let r=[];for(let e=0;e<ne.length;e++){r[e]=[];for(let t=0;t<ne[0].length;t++)r[e][t]=ne[ne.length-1-e][ne[0].length-1-t]}let a=[];for(let e=0;e<ne[0].length;e++){a[e]=[];for(let t=0;t<ne.length;t++)a[e][t]=ne[ne.length-t-1][e]}let i=[];for(let e=0;e<ne[0].length;e++){i[e]=[];for(let t=0;t<ne.length;t++)i[e][t]=ne[t][ne[0].length-1-e]}ie=[],ae.push(new X(ne,_.cloneDeep(w),$e)),ae.push(new X(a,_.cloneDeep(w),(()=>!1))),ae.push(new X(r,_.cloneDeep(w),(()=>!1))),ae.push(new X(i,_.cloneDeep(w),(()=>!1)));let l=0!=ae[0].longSpaces.length;const c=ae[0].solve();let s,d;if(l){const e=ae[1].solve(),t=ae[2].solve(),n=ae[3].solve();s=await Promise.race([c,e,t,n])}else s=await c;for(let e of ae)e.stop();if(void 0!==ae[0].success){for(let e=0;e<ae[0].board.length;e++)for(let t=0;t<ae[0].board[0].length;t++)ne[e][t]=ae[0].board[e][t];d=ae[0],ie=ae[0].history}else if(void 0!==ae[1].success){for(let e=0;e<ae[1].board[0].length;e++)for(let t=0;t<ae[1].board.length;t++)ne[e][t]=ae[1].board[t][ae[1].board[0].length-1-e];for(let e of ae[1].history)for(let t of e){let e=t.y;t.y=ae[1].board[0].length-1-t.x,t.x=e}d=ae[1],ie=ae[1].history}else if(void 0!==ae[2].success){for(let e=0;e<ae[2].board.length;e++)for(let t=0;t<ae[2].board[0].length;t++)ne[e][t]=ae[2].board[ae[2].board.length-1-e][ae[2].board[0].length-1-t];for(let e of ae[2].history)for(let t of e)t.y=ae[2].board.length-1-t.y,t.x=ae[2].board[0].length-1-t.x;d=ae[2],ie=ae[2].history}else if(void 0!==ae[3].success){for(let e=0;e<ae[3].board[0].length;e++)for(let t=0;t<ae[3].board.length;t++)ne[e][t]=ae[3].board[ae[3].board.length-t-1][e];for(let e of ae[3].history)for(let t of e){let e=t.x;t.x=ae[3].board.length-1-t.y,t.y=e}d=ae[3],ie=ae[3].history}return document.getElementById("iterations").style.visibility="visible",document.getElementById("iterationsValue").innerText=`${d.iterations}`,document.getElementById("time").style.visibility="visible",document.getElementById("timeValue").innerText=(new Date).getTime()-d.time+"ms",s&&ke(),s}()||(document.getElementById("failText").style.visibility="visible"),e.target.innerText=s("reset"),pe=de;break;case ce:e.target.innerText=s("continue");for(let e of ae)e.pause();pe=se,document.getElementById("resetButton").style.visibility="visible";break;case se:e.target.innerText=s("pause"),ie=[];for(let e of ae)e.continue();pe=ce,document.getElementById("resetButton").style.visibility="hidden";break;case de:Pe()}})),document.getElementById("resetButton").addEventListener("click",Pe),document.getElementById("darkMode").addEventListener("click",Ce);let me,fe=!1;for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++){let n=xe(e,t);n.addEventListener("mousedown",(()=>{me=0==ne[e][t]?-1:0,Se(e,t,me),fe=!0})),n.addEventListener("mouseover",(()=>{fe?Se(e,t,me):we(e,t)})),n.addEventListener("mouseout",(()=>{fe||Ie(e,t)}))}function be(){for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++)xe(e,t).style.borderWidth="1px";for(let e=0;e<ne[0].length/2;e++)xe(e,e).style.borderTopWidth="3px",xe(e,e).style.borderRightWidth="3px",xe(ne.length-e-1,e).style.borderBottomWidth="3px",xe(ne.length-e-1,e).style.borderRightWidth="3px",xe(e,ne[0].length-e-1).style.borderTopWidth="3px",xe(e,ne[0].length-e-1).style.borderLeftWidth="3px",xe(ne.length-e-1,ne[0].length-e-1).style.borderBottomWidth="3px",xe(ne.length-e-1,ne[0].length-e-1).style.borderLeftWidth="3px";for(let e=0;e<ne.length;e++)xe(e,0).style.borderLeftWidth="3px",xe(e,ne[0].length/2).style.borderLeftWidth="3px",xe(e,ne[0].length-1).style.borderRightWidth="3px";for(let e=0;e<ne[0].length;e++)xe(0,e).style.borderTopWidth="3px",xe(ne.length/2,e).style.borderTopWidth="3px",xe(ne.length-1,e).style.borderBottomWidth="3px";for(let e=ne.length/4;e<3*ne.length/4;e++)xe(e,Math.floor(ne[0].length/4)).style.borderLeftWidth="3px",xe(e,Math.floor(3*ne[0].length/4)).style.borderRightWidth="3px";for(let e=Math.ceil(ne[0].length/4);e<Math.floor(3*ne[0].length/4);e++)xe(ne.length/4,e).style.borderTopWidth="3px",xe(3*ne.length/4,e).style.borderTopWidth="3px"}document.documentElement.addEventListener("mouseup",(()=>{fe=!1})),document.getElementById("legion").addEventListener("dragstart",(e=>e.preventDefault()));let ye=!1;function ve(e,t){for(let n=0;n<ge.length;n++)for(let o of ge[n])if(o.x==e&&o.y==t)return n}function xe(e,t){return document.getElementById("legionBoard").getElementsByTagName("tr")[e].getElementsByTagName("td")[t]}function Se(e,t,n){if(pe!=le)return;if(he)if(0==n)for(let n of ge[ve(e,t)])xe(n.x,n.y).style.background=k.get(0),-1==ne[n.x][n.y]&&re++,ne[n.x][n.y]=0;else for(let n of ge[ve(e,t)])xe(n.x,n.y).style.background=k.get(-1),0==ne[n.x][n.y]&&re--,ne[n.x][n.y]=-1;else{let o=xe(e,t);-1==n?-1!=ne[e][t]&&(ne[e][t]=-1,o.style.background=k.get(-1),re--):0!=ne[e][t]&&(ne[e][t]=0,o.style.background=k.get(0),re++)}const o=`${Y}${ee}`,r=`${Z}${ee}`;localStorage.setItem(o,JSON.stringify(ne)),localStorage.setItem("legionBoard",JSON.stringify(ne)),localStorage.setItem(r,JSON.stringify(re)),localStorage.setItem("boardFilled",JSON.stringify(re)),document.getElementById("boardFilledValue").innerText=`${re}`,V()}function we(e,t){if(pe==le)if(he)for(let n of ge[ve(e,t)])-1==ne[n.x][n.y]?xe(n.x,n.y).style.background=ye?"dimgrey":"silver":xe(n.x,n.y).style.background=ye?"rgb(20, 20, 20)":"dimgrey";else-1==ne[e][t]?xe(e,t).style.background=ye?"dimgrey":"silver":xe(e,t).style.background=ye?"rgb(20, 20, 20)":"dimgrey"}function Ie(e,t){if(pe==le)if(he)for(let n of ge[ve(e,t)])-1==ne[n.x][n.y]?xe(n.x,n.y).style.background=k.get(-1):xe(n.x,n.y).style.background=k.get(0);else-1==ne[e][t]?xe(e,t).style.background=k.get(-1):xe(e,t).style.background=k.get(0)}function ke(){be(),Ee()}function Ee(){document.getElementById("darkMode").checked?(k.set(-1,"#2a2a2a"),k.set(0,"#444")):(k.set(-1,"white"),k.set(0,"grey"));for(let e=0;e<ne.length;e++)for(let t=0;t<ne[0].length;t++)if(-1!=ne[e][t]){let n=xe(e,t);ve(e,t),0==ne[e][t]?n.style.background=k.get(0):ne[e][t]>0&&(n.style.background=k.get(ne[e][t]))}0==ie.length&&ae[0]&&(ie=ae[0].history);for(let e of ie)for(let t=0;t<e.length;t++){ne[e[t].y][e[t].x-1]>0&&("3px"==xe(e[t].y,e[t].x).style.borderLeftWidth||"3px"==xe(e[t].y,e[t].x-1).style.borderRightWidth)&&(xe(e[t].y,e[t].x).style.borderLeftWidth="1px",xe(e[t].y,e[t].x-1).style.borderRightWidth="1px"),ne[e[t].y-1]&&ne[e[t].y-1][e[t].x]>0&&("3px"==xe(e[t].y,e[t].x).style.borderTopWidth||"3px"==xe(e[t].y-1,e[t].x).style.borderBottomWidth)&&(xe(e[t].y,e[t].x).style.borderTopWidth="1px",xe(e[t].y-1,e[t].x).style.borderBottomWidth="1px");for(let n=0;n<e.length;n++)t!=n&&e[t].x-1==e[n].x&&e[t].y==e[n].y&&(xe(e[t].y,e[t].x).style.borderLeftWidth="0px",ne[0][e[t].x-1]&&(xe(e[t].y,e[t].x-1).style.borderRightWidth="0px")),t!=n&&e[t].x==e[n].x&&e[t].y-1==e[n].y&&(xe(e[t].y,e[t].x).style.borderTopWidth="0px",ne[e[t].y-1]&&(xe(e[t].y-1,e[t].x).style.borderBottomWidth="0px"))}}function Ce(){let e=document.getElementById("darkMode").checked;localStorage.setItem("isDarkMode",JSON.stringify(e)),e?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode"),Ee()}function Be(){he=!he,localStorage.setItem("isBigClick",JSON.stringify(he)),q()}function Le(){ue=!ue,localStorage.setItem("isLiveSolve",JSON.stringify(ue)),ue&&pe!=de&&ke(),q()}function Pe(){!function(){for(let e=0;e<ae.length;e++)for(let t=0;t<ae[e].board.length;t++)for(let n=0;n<ae[e].board[0].length;n++)0==e?(xe(t,n).style.borderWidth="1px",ae[e].board[t][n]>=0&&(xe(t,n).style.background=k.get(0),ae[e].board[t][n]=0)):ae[e].board[t][n]>=0&&(ae[e].board[t][n]=0);be(),ae=[]}(),document.getElementById("clearBoard").disabled=!1,document.getElementById("boardButton").innerText=s("start"),document.getElementById("resetButton").style.visibility="hidden",document.getElementById("iterations").style.visibility="hidden",document.getElementById("time").style.visibility="hidden",document.getElementById("failText").style.visibility="hidden",ie=[],pe=le,q()}function $e(){ue&&ke()}localStorage.getItem("isDarkMode")&&(document.getElementById("darkMode").checked=JSON.parse(localStorage.getItem("isDarkMode")),JSON.parse(localStorage.getItem("isDarkMode"))&&Ce()),document.addEventListener("DOMContentLoaded",(()=>{!function(){const e=localStorage.getItem("isDarkMode");if(e){const t=JSON.parse(e);document.getElementById("darkMode").checked=t,t&&document.body.classList.add("dark-mode")}Ee()}()}));const Te="legionSolver_activePreset";let De=localStorage.getItem(Te)?parseInt(localStorage.getItem(Te)):1;function Ne(){console.log("Setting up board state monitoring");let e=null,t=null;setInterval((()=>{const n=document.getElementById("boardButton"),o=n?n.innerText:null,r=localStorage.getItem("boardFilled"),a=document.getElementById("boardFilledValue");o&&o!==s("start")&&(null!==t&&t!==s("start")||(console.log(`Board state changed to ${o}, recording filled count: ${r}`),e=r),e&&(!r||0===parseInt(r)||parseInt(r)<.5*parseInt(e))?(console.log(`BoardFilled reset detected! Restoring from ${r} to ${e}`),localStorage.setItem("boardFilled",e),localStorage.setItem(`boardFilled_preset_${De}`,e),a&&(a.innerText=JSON.parse(e)),V()):r&&parseInt(r)>0&&(e=r)),t=o}),500)}function Ae(e,t,n){if(!e||!e.shape)return console.error(`Cannot verify transformations for piece #${t+1} (${n}) - invalid piece or shape`),!1;const o=e.transformations;if(!o||0===o.length)return console.error(`Piece #${t+1} (${n}) has no transformations`),!1;console.log(`Piece #${t+1} (${n}) has ${o.length} unique orientations`);let r=!0;for(let e=0;e<o.length;e++){const n=o[e];if(!n.shape||!n.pointShape){console.error(`Transformation #${e+1} for piece #${t+1} is invalid`),r=!1;continue}const a=n.cellCount,i=n.pointShape.length;if(a!==i&&(console.error(`Transformation #${e+1} for piece #${t+1} has inconsistent cell count (${a}) and point count (${i})`),r=!1),e<2){const t=n.shape.map((e=>e.map((e=>0===e?"□":1===e?"■":"▣")).join(""))).join("\n");console.log(`Transformation #${e+1}:\n${t}`)}}return r}function Fe(){if(console.log("Updating pieces for solver"),window._isUpdatingPiecesForSolver)console.log("Already updating pieces for solver, preventing recursive call");else{window._isUpdatingPiecesForSolver=!0;try{De=localStorage.getItem(Te)?parseInt(localStorage.getItem(Te)):1,P(),window._isSavingPreset||V()}finally{window._isUpdatingPiecesForSolver=!1}}}window.updatePiecesForSolver=Fe,window.monitorBoardState=Ne,document.addEventListener("DOMContentLoaded",(function(){console.log("DOM content loaded, initializing application"),document.getElementById("characterSelector"),document.querySelector(".filterContainer"),setTimeout((()=>{N()}),100),setTimeout((()=>{Ne()}),1e3),function(){if(console.log("Verifying piece shapes..."),!window.pieces||!Array.isArray(window.pieces))return void console.error("Pieces array not available for verification");const e=[{name:"Lvl 60 (All classes)",cells:1},{name:"Lvl 100 (All classes)",cells:2},{name:"Lvl 140 Warrior/Pirate",cells:3},{name:"Lvl 140 Mage/Thief/Archer",cells:3},{name:"Lvl 200 Warrior",cells:4},{name:"Lvl 200 Archer",cells:4},{name:"Lvl 200 Thief/Lab",cells:4},{name:"Lvl 200 Mage",cells:4},{name:"Lvl 200 Pirate",cells:4},{name:"Lvl 250 Warrior",cells:5},{name:"Lvl 250 Archer",cells:5},{name:"Lvl 250 Thief",cells:5},{name:"Lvl 250 Mage",cells:5},{name:"Lvl 250 Pirate",cells:5},{name:"Lvl 250 Xenon",cells:5}];let t=!0;window.pieces.length<e.length&&(console.error(`Pieces array has fewer items than expected: ${window.pieces.length} vs ${e.length}`),t=!1);for(let n=0;n<Math.min(window.pieces.length,e.length);n++){const o=window.pieces[n],r=e[n];if(!o.shape){console.error(`Piece #${n+1} (${r.name}) has no shape defined`),t=!1;continue}const a=o.cellCount;a!==r.cells&&(console.error(`Piece #${n+1} (${r.name}) has ${a} cells, expected ${r.cells}`),t=!1),Ae(o,n,r.name)}t?console.log("All piece shapes verified successfully"):console.warn("Some piece shapes have issues - the solver may not work correctly")}(),function(){const e=document.getElementById("boardButton");e&&(console.log("Setting up backup handler for board button"),e.addEventListener("click",(function(e){console.log("Board button clicked from main.js"),Fe()})));const t=document.getElementById("pieceSelectionContent");t&&(console.log("Setting up mutation observer for piece selection"),new MutationObserver((function(e){Fe()})).observe(t,{childList:!0}))}(),console.log("Application initialization complete")})),window.addEventListener("load",(function(){const e=document.getElementById("characterSelector");e&&0===e.children.length&&(console.log("Character selector is empty, reinitializing"),N())})),window.debugPieceMapping=function(e){if(!window.levelToPieceIndex||!window.pieces)return void console.log("levelToPieceIndex or pieces not available for debugging");const t=e,n=t.querySelector(".name").textContent,o=t.getAttribute("data-class"),r=t.getAttribute("data-level"),a=parseInt(r.replace("Lvl ","")),i=parseInt(t.getAttribute("data-piece-index")),l=window.levelToPieceIndex[o][a]||null;if(console.log(`${n} (${o} ${r}):`),console.log(`- Expected piece ID: ${l}`),console.log(`- Actual piece index: ${i}`),l!==i&&console.warn(`⚠️ MISMATCH: Expected piece ID ${l}, but got ${i}`),l&&window.pieces&&l-1>=0&&l-1<window.pieces.length){const e=window.pieces[l-1];e&&(console.log("Expected shape:"),window.visualizePieceShape(e.cells))}},window.visualizePieceShape=function(e){const t=e.map((e=>e.map((e=>0===e?"□":1===e?"■":"▣")).join(" "))).join("\n");console.log(t)}}},e=>{e.O(0,[502],(()=>e(e.s=143))),e.O()}]);